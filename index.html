<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>í¬ë¦½í†  ë°”ì´ë°± ëŒ€ì‹œë³´ë“œ</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0a0a0f;--card:#16161f;--card-h:#1c1c28;
  --brd:#2a2a3a;--brd-l:#353545;
  --t1:#e8e8f0;--t2:#8888a0;--t3:#555570;
  --grn:#00e599;--grn-d:rgba(0,229,153,0.15);
  --blu:#3b82f6;--blu-d:rgba(59,130,246,0.15);
  --pur:#a855f7;--pur-d:rgba(168,85,247,0.15);
  --org:#f59e0b;--org-d:rgba(245,158,11,0.15);
  --red:#ef4444;--red-d:rgba(239,68,68,0.15);
  --cyn:#06b6d4;--cyn-d:rgba(6,182,212,0.15);
}
*{margin:0;padding:0;box-sizing:border-box}
html{-webkit-text-size-adjust:100%}
body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--t1);min-height:100vh;overflow-x:hidden;-webkit-font-smoothing:antialiased}
.mono{font-family:'JetBrains Mono',monospace}

/* === HEADER === */
.hdr{padding:16px 16px 14px;border-bottom:1px solid var(--brd);background:linear-gradient(180deg,rgba(0,229,153,0.03),transparent)}
.hdr-top{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}
.hdr-left{display:flex;align-items:center;gap:10px}
.logo{width:32px;height:32px;background:linear-gradient(135deg,var(--grn),#00b377);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#0a0a0f}
.hdr h1{font-size:16px;font-weight:700;background:linear-gradient(135deg,var(--t1),var(--grn));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hdr-sub{font-size:9px;color:var(--t3);letter-spacing:.4px}
.hdr-right{display:flex;align-items:center;gap:6px}
.ubadge{display:flex;align-items:center;gap:4px;padding:4px 8px;background:var(--card);border:1px solid var(--brd);border-radius:6px;font-size:9px;color:var(--t2)}
.udot{width:5px;height:5px;background:var(--grn);border-radius:50%;animation:pulse 2s infinite}
.udot.err{background:var(--red)}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
.psel{display:flex;background:var(--card);border:1px solid var(--brd);border-radius:6px;overflow:hidden}
.pbtn{padding:5px 11px;font-size:11px;font-weight:500;background:transparent;color:var(--t2);border:none;cursor:pointer;transition:all .15s;font-family:'Outfit',sans-serif;-webkit-tap-highlight-color:transparent}
.pbtn.on{background:var(--grn);color:#0a0a0f;font-weight:600}
.pbtn:active:not(.on){background:var(--card-h)}

/* === INFO === */
.info{margin:12px 16px 0;background:linear-gradient(135deg,rgba(0,229,153,0.06),rgba(59,130,246,0.04));border:1px solid rgba(0,229,153,0.15);border-radius:10px;padding:14px}
.info-title{font-size:12px;font-weight:600;color:var(--grn);margin-bottom:8px;display:flex;align-items:center;gap:5px}
.info-grid{display:grid;grid-template-columns:1fr;gap:8px}
.info-item{display:flex;gap:7px;align-items:flex-start}
.info-ic{width:22px;height:22px;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:11px;flex-shrink:0}
.info-lbl{font-size:11px;font-weight:600;color:var(--t1);margin-bottom:1px}
.info-desc{font-size:10px;color:var(--t2);line-height:1.45}
.info-tog{display:flex;align-items:center;gap:4px;background:none;border:none;color:var(--grn);font-size:10px;font-weight:500;cursor:pointer;font-family:'Outfit',sans-serif;padding:0;margin-top:8px;-webkit-tap-highlight-color:transparent}
.info-det{display:none;margin-top:10px;padding-top:10px;border-top:1px solid rgba(0,229,153,0.1)}
.info-det.show{display:block}
.info-det-txt{font-size:10px;color:var(--t2);line-height:1.65}
.info-det-txt strong{color:var(--t1)}
.ihl{display:inline-block;background:var(--grn-d);color:var(--grn);padding:0 4px;border-radius:3px;font-size:9px;font-weight:500}
.tcmp{display:grid;grid-template-columns:1fr;gap:6px;margin-top:8px}
.tcmp-box{background:var(--card);border:1px solid var(--brd);border-radius:6px;padding:7px 10px;text-align:center}
.tcmp-box .lb{font-size:8px;color:var(--t3);text-transform:uppercase;letter-spacing:.4px;margin-bottom:2px}
.tcmp-box .vl{font-size:10px;font-weight:600}
.tcmp-arr{font-size:12px;color:var(--t3);text-align:center}

/* === SUMMARY === */
.srow{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:12px 16px}
.scard{background:var(--card);border:1px solid var(--brd);border-radius:9px;padding:12px 14px}
.slbl{font-size:9px;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:5px;display:flex;align-items:center;gap:4px}
.ttip{display:inline-flex;align-items:center;justify-content:center;width:12px;height:12px;border-radius:50%;background:var(--bg);border:1px solid var(--brd);font-size:7px;color:var(--t3);cursor:help;position:relative}
.ttip:hover .ttip-box,.ttip:active .ttip-box{display:block}
.ttip-box{display:none;position:absolute;top:100%;left:50%;transform:translateX(-50%);margin-top:4px;background:#22222e;border:1px solid var(--brd-l);border-radius:6px;padding:7px 9px;font-size:9px;color:var(--t2);line-height:1.4;width:160px;z-index:100;font-weight:400;text-transform:none;letter-spacing:0;box-shadow:0 6px 20px rgba(0,0,0,.4)}
.sval{font-size:20px;font-weight:700;letter-spacing:-.5px}
.ssub{font-size:9px;color:var(--t2);margin-top:2px}

/* === MAIN === */
.main{padding:0 16px 16px}
.sec-hd{margin-bottom:10px}
.sec-t{font-size:13px;font-weight:600;color:var(--t1);display:flex;align-items:center;gap:5px}
.sec-d{font-size:9px;color:var(--t3);margin-top:1px}

/* === BAR CHART (MOBILE-FIRST STACKED) === */
.chart-sec{margin-bottom:16px}
.chart-box{background:var(--card);border:1px solid var(--brd);border-radius:10px;padding:14px}
.bchart{display:flex;flex-direction:column;gap:2px}
.brow{padding:8px 0;border-bottom:1px solid rgba(255,255,255,.02)}
.brow:last-child{border-bottom:none}
.brow-top{display:flex;align-items:center;justify-content:space-between;gap:6px;margin-bottom:4px}
.brow-name-area{display:flex;align-items:center;gap:6px;min-width:0;flex:1}
.brow-ci{width:18px;height:18px;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;flex-shrink:0}
.brow-mdot{width:5px;height:5px;border-radius:50%;flex-shrink:0}
.brow-names{display:flex;flex-direction:column;min-width:0;flex:1}
.brow-name{font-size:12px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.brow-ko{font-size:9px;color:var(--t2);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.brow-val{font-size:13px;font-weight:600;white-space:nowrap;flex-shrink:0}
.brow-bar{height:18px;background:rgba(255,255,255,.03);border-radius:4px;overflow:hidden}
.brow-fill{height:100%;border-radius:4px;transition:width .8s cubic-bezier(.25,.46,.45,.94);min-width:2px}

/* === PROTOCOL CARDS === */
.pgrid{display:grid;grid-template-columns:1fr;gap:10px;margin-bottom:16px}
.pcard{background:var(--card);border:1px solid var(--brd);border-radius:10px;padding:14px;display:flex;flex-direction:column;gap:10px;-webkit-tap-highlight-color:transparent}
.pcard:active{border-color:var(--brd-l)}
.pc-top{display:flex;align-items:flex-start;justify-content:space-between;gap:6px}
.pc-left{display:flex;align-items:center;gap:8px;min-width:0;flex:1}
.pc-rank{font-size:16px;font-weight:800;color:var(--t3);width:22px;text-align:center;flex-shrink:0}
.pc-rank.t3{color:var(--grn)}
.pc-ncol{min-width:0;flex:1}
.pc-name{font-size:14px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pc-ko{font-size:10px;color:var(--t2)}
.pc-cat{font-size:9px;color:var(--t3)}
.pc-badges{display:flex;gap:3px;flex-wrap:wrap;flex-shrink:0}
.cbadge{display:flex;align-items:center;gap:3px;padding:2px 6px;border-radius:4px;font-size:9px;font-weight:500;border:1px solid}
.cbadge-ic{width:12px;height:12px;border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:7px;font-weight:700}
.mbadge{padding:2px 6px;border-radius:4px;font-size:9px;font-weight:600;display:flex;align-items:center;gap:2px}
.mb-burn{background:var(--red-d);color:var(--red)}
.mb-stake{background:var(--pur-d);color:var(--pur)}
.mb-dist{background:var(--cyn-d);color:var(--cyn)}

.pc-amt{font-size:20px;font-weight:700;color:var(--grn);letter-spacing:-.5px}
.pc-amt-sub{font-size:10px;color:var(--t3);margin-top:1px}

.pc-metrics{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px}
.pc-m{padding:7px 8px;background:var(--bg);border-radius:6px}
.pc-ml{font-size:8px;color:var(--t3);text-transform:uppercase;letter-spacing:.3px;margin-bottom:2px}
.pc-mv{font-size:12px;font-weight:600}

.pc-ratio{padding:7px 8px;background:var(--bg);border-radius:6px}
.pc-rh{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}
.pc-rl{font-size:8px;color:var(--t3);text-transform:uppercase;letter-spacing:.3px}
.pc-rv{font-size:11px;font-weight:600}
.pc-rt{height:4px;background:rgba(255,255,255,.05);border-radius:2px;overflow:hidden}
.pc-rf{height:100%;border-radius:2px;transition:width .6s ease}

/* === TABLE === */
.tsec{margin-bottom:16px}
.tbox{background:var(--card);border:1px solid var(--brd);border-radius:10px;overflow:hidden}
.tscrl{overflow-x:auto;-webkit-overflow-scrolling:touch}
table{width:100%;border-collapse:collapse;min-width:680px}
thead th{padding:9px 10px;font-size:9px;font-weight:600;color:var(--t3);text-transform:uppercase;letter-spacing:.6px;text-align:left;border-bottom:1px solid var(--brd);background:rgba(255,255,255,.01);white-space:nowrap;cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent}
thead th:hover{color:var(--t2)}
thead th.sorted{color:var(--grn)}
tbody tr{transition:background .1s}
tbody tr:active{background:rgba(255,255,255,.02)}
tbody td{padding:8px 10px;font-size:11px;border-bottom:1px solid rgba(255,255,255,.03);white-space:nowrap}
.td-cb{font-size:8px;padding:2px 5px;border-radius:3px;background:var(--bg);border:1px solid var(--brd)}
.td-mb{font-size:8px;padding:1px 4px;border-radius:3px;font-weight:600}
.td-name{display:flex;flex-direction:column;gap:1px}
.td-ko{font-size:9px;color:var(--t2);font-weight:400}

/* === LEGEND === */
.legend{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:14px;padding:0 2px}
.legend-item{display:flex;align-items:center;gap:4px;font-size:10px;color:var(--t2)}
.legend-dot{width:8px;height:8px;border-radius:50%}

/* === LOADING / ERROR === */
.ld-box{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:50px 20px;gap:12px}
.ld-spin{width:28px;height:28px;border:3px solid var(--brd);border-top-color:var(--grn);border-radius:50%;animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.ld-txt{font-size:11px;color:var(--t2)}
.err-box{text-align:center;padding:40px 20px}
.err-ic{font-size:28px;margin-bottom:8px}
.err-txt{font-size:12px;color:var(--t2);margin-bottom:5px}
.err-sub{font-size:10px;color:var(--t3);margin-bottom:12px}
.retry{padding:6px 16px;background:var(--grn);color:#0a0a0f;border:none;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;font-family:'Outfit',sans-serif;-webkit-tap-highlight-color:transparent}

/* === FOOTER === */
.ftr{padding:12px 16px;border-top:1px solid var(--brd);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:4px}
.ftr-txt{font-size:9px;color:var(--t3)}
.ftr-link{color:var(--grn);text-decoration:none}

/* === DESKTOP === */
@media(min-width:768px){
  .hdr{padding:20px 24px 16px}
  .hdr h1{font-size:20px}
  .info{margin:16px 24px 0;padding:16px 18px}
  .info-grid{grid-template-columns:repeat(3,1fr)}
  .tcmp{grid-template-columns:1fr auto 1fr}
  .srow{grid-template-columns:repeat(4,1fr);padding:16px 24px;gap:10px}
  .sval{font-size:22px}
  .main{padding:0 24px 24px}
  .pgrid{grid-template-columns:repeat(auto-fill,minmax(320px,1fr))}
  .ftr{padding:14px 24px}
}
@media(min-width:1200px){
  .hdr{padding:24px 32px 20px}
  .hdr h1{font-size:22px}
  .info{margin:20px 32px 0;padding:18px 20px}
  .srow{padding:20px 32px;gap:12px}
  .main{padding:0 32px 32px}
}
@media(max-width:380px){
  .sval{font-size:17px}
  .pc-amt{font-size:17px}
  .brow-name{font-size:11px}
}

/* === IMWEB IFRAME === */
body.in-iframe{overflow:visible !important}
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--brd);border-radius:2px}
</style>
</head>
<body>

<!-- HEADER -->
<div class="hdr">
  <div class="hdr-top">
    <div class="hdr-left">
      <div class="logo">BB</div>
      <div>
        <h1>í¬ë¦½í†  ë°”ì´ë°± ëŒ€ì‹œë³´ë“œ</h1>
        <div class="hdr-sub">PROTOCOL BUYBACK & HOLDER REVENUE TRACKER</div>
      </div>
    </div>
    <div class="hdr-right">
      <div class="ubadge"><span class="udot" id="sDot"></span><span id="uTime">ë¡œë”© ì¤‘...</span></div>
      <div class="psel">
        <button class="pbtn on" data-p="24h" onclick="chgP('24h')">24H</button>
        <button class="pbtn" data-p="7d" onclick="chgP('7d')">7D</button>
        <button class="pbtn" data-p="30d" onclick="chgP('30d')">30D</button>
      </div>
    </div>
  </div>
</div>

<!-- INFO -->
<div class="info">
  <div class="info-title">ğŸ’¡ í¬ë¦½í†  ë°”ì´ë°±ì´ë€?</div>
  <div class="info-grid">
    <div class="info-item">
      <div class="info-ic" style="background:var(--grn-d);color:var(--grn)">ğŸ’°</div>
      <div>
        <div class="info-lbl">Holders Revenue (í™€ë” ìˆ˜ìµ)</div>
        <div class="info-desc">í”„ë¡œí† ì½œ ìˆ˜ìµ ì¤‘ <strong>í† í° ë³´ìœ ìì—ê²Œ ëŒë ¤ì£¼ëŠ” ê¸ˆì•¡</strong>. ì£¼ì‹ì˜ ë°°ë‹¹+ìì‚¬ì£¼ë§¤ì… ê°œë….</div>
      </div>
    </div>
    <div class="info-item">
      <div class="info-ic" style="background:var(--red-d);color:var(--red)">ğŸ”¥</div>
      <div>
        <div class="info-lbl">ë°”ì´ë°± ë°©ì‹</div>
        <div class="info-desc"><strong>ğŸ”¥ì†Œê°</strong>=í† í° ì‚­ì œ(ê³µê¸‰â†“) Â· <strong>ğŸ’ìŠ¤í…Œì´í‚¹</strong>=ë³´ìœ ì ë³´ìƒ Â· <strong>ğŸ’¸ë°°ë¶„</strong>=ìˆ˜ìµ ë¶„ë°°</div>
      </div>
    </div>
    <div class="info-item">
      <div class="info-ic" style="background:var(--pur-d);color:var(--pur)">ğŸ“Š</div>
      <div>
        <div class="info-lbl">ë°”ì´ë°± ë¹„ìœ¨</div>
        <div class="info-desc">Revenue ëŒ€ë¹„ Holders Revenue. <strong>ë†’ì„ìˆ˜ë¡ íˆ¬ìì í™˜ì› ì ê·¹ì </strong>.</div>
      </div>
    </div>
  </div>
  <button class="info-tog" onclick="togDet()"><span id="togIc">â–¶</span> ì£¼ì‹ íˆ¬ììë¥¼ ìœ„í•œ ë¹„êµ</button>
  <div class="info-det" id="infoDet">
    <div class="tcmp">
      <div class="tcmp-box"><div class="lb">ğŸ¢ ì£¼ì‹</div><div class="vl" style="color:var(--blu)">ë§¤ì¶œâ†’ì˜ì—…ì´ìµâ†’ë°°ë‹¹+ìì‚¬ì£¼ë§¤ì…</div></div>
      <div class="tcmp-arr">â‰ˆ</div>
      <div class="tcmp-box"><div class="lb">â›“ï¸ í¬ë¦½í† </div><div class="vl" style="color:var(--grn)">Feesâ†’Revenueâ†’Holders Revenue</div></div>
    </div>
    <div class="info-det-txt" style="margin-top:10px">
      <strong>Fees</strong>=ì‚¬ìš©ì ìˆ˜ìˆ˜ë£Œâ†’<span class="ihl">ë§¤ì¶œì•¡</span> Â· <strong>Revenue</strong>=í”„ë¡œí† ì½œ ìˆ˜ìµâ†’<span class="ihl">ì˜ì—…ì´ìµ</span> Â· <strong>Holders Revenue</strong>=í† í° ë³´ìœ ì í™˜ì›â†’<span class="ihl">ë°°ë‹¹+ìì‚¬ì£¼ë§¤ì…</span><br><br>
      ğŸ”¥ <strong>Pump.fun</strong>: Revenue <span class="ihl">100%</span>ë¥¼ ë§¤ì¼ PUMP ë°”ì´ë°±. ëˆ„ì  $98M+, ìœ í†µëŸ‰ 6.7%â†“
    </div>
  </div>
</div>

<!-- SUMMARY -->
<div class="srow">
  <div class="scard">
    <div class="slbl">ì „ì²´ ë°”ì´ë°± <span class="ttip">?<div class="ttip-box">ë³´ìœ ìì—ê²Œ í™˜ì›ëœ ì´ ê¸ˆì•¡</div></span></div>
    <div class="sval" id="sHR">-</div>
    <div class="ssub" id="sHRs">Holders Revenue í•©ê³„</div>
  </div>
  <div class="scard">
    <div class="slbl">ì „ì²´ Revenue</div>
    <div class="sval" id="sRev">-</div>
    <div class="ssub" id="sRevs">í”„ë¡œí† ì½œ ìˆ˜ìµ í•©ê³„</div>
  </div>
  <div class="scard">
    <div class="slbl">ë°”ì´ë°± ë¹„ìœ¨</div>
    <div class="sval" id="sRat">-</div>
    <div class="ssub">HR Ã· Revenue</div>
  </div>
  <div class="scard">
    <div class="slbl">í”„ë¡œí† ì½œ ìˆ˜</div>
    <div class="sval" id="sCnt">-</div>
    <div class="ssub" id="sCnts">ë°”ì´ë°± í”„ë¡œí† ì½œ</div>
  </div>
</div>

<div class="main">
  <!-- BAR CHART -->
  <div class="chart-sec">
    <div class="sec-hd">
      <div class="sec-t">ğŸ“Š í”„ë¡œí† ì½œë³„ ë°”ì´ë°± TOP 15</div>
      <div class="sec-d">Holders Revenue ê¸°ì¤€ ìƒìœ„ í”„ë¡œí† ì½œ</div>
    </div>
    <!-- Legend -->
    <div class="legend">
      <div class="legend-item"><div class="legend-dot" style="background:var(--red)"></div>ğŸ”¥ ì†Œê°</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--pur)"></div>ğŸ’ ìŠ¤í…Œì´í‚¹</div>
      <div class="legend-item"><div class="legend-dot" style="background:var(--cyn)"></div>ğŸ’¸ ë°°ë¶„</div>
    </div>
    <div class="chart-box">
      <div class="bchart" id="barChart">
        <div class="ld-box"><div class="ld-spin"></div><div class="ld-txt">DefiLlama API ë¡œë”© ì¤‘...</div></div>
      </div>
    </div>
  </div>

  <!-- CARDS -->
  <div class="sec-hd">
    <div class="sec-t">ğŸ”¥ ë°”ì´ë°± í”„ë¡œí† ì½œ ìƒì„¸ TOP 10</div>
    <div class="sec-d">ë°©ì‹ Â· ì²´ì¸ Â· ëˆ„ì  ê¸ˆì•¡ Â· ë¹„ìœ¨</div>
  </div>
  <div class="pgrid" id="pGrid"></div>

  <!-- TABLE -->
  <div class="tsec">
    <div class="sec-hd">
      <div class="sec-t">ğŸ† ì „ì²´ ë°”ì´ë°± í”„ë¡œí† ì½œ</div>
      <div class="sec-d">ì—´ í„°ì¹˜ ì‹œ ì •ë ¬</div>
    </div>
    <div class="tbox">
      <div class="tscrl">
        <table>
          <thead><tr>
            <th onclick="srt('rank')">#</th>
            <th onclick="srt('name')">í”„ë¡œí† ì½œ</th>
            <th onclick="srt('chain')">ì²´ì¸</th>
            <th>ë°©ì‹</th>
            <th onclick="srt('holdersRevenue')" class="sorted">ë°”ì´ë°± â–¼</th>
            <th onclick="srt('revenue')">Revenue</th>
            <th onclick="srt('ratio')">ë¹„ìœ¨</th>
            <th onclick="srt('allTime')">ëˆ„ì </th>
          </tr></thead>
          <tbody id="tBody"><tr><td colspan="8" style="text-align:center;padding:30px;color:var(--t3)">ë¡œë”© ì¤‘...</td></tr></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="ftr">
  <span class="ftr-txt">ë°ì´í„°: <a href="https://defillama.com" target="_blank" class="ftr-link">DefiLlama</a> ë¬´ë£Œ API Â· ì‹¤ì‹œê°„</span>
  <span class="ftr-txt">í´ë ˆë²„ë¼ Â· Klevera</span>
</div>

<script>
// ===== KOREAN LABELS =====
const KO={
  'hyperliquid perps':'í•˜ì´í¼ë¦¬í€´ë“œ ë¬´ê¸°í•œì„ ë¬¼',
  'pump.fun':'íŒí”„í€ Â· ë°ˆì½”ì¸ ëŸ°ì¹˜íŒ¨ë“œ',
  'tron':'íŠ¸ë¡  Â· L1 ì²´ì¸',
  'jupiter perpetual exchange':'ì£¼í”¼í„° ë¬´ê¸°í•œì„ ë¬¼',
  'yield basis':'ì¼ë“œ ë² ì´ì‹œìŠ¤ Â· ìˆ˜ìµ í”„ë¡œí† ì½œ',
  'jupiter aggregator':'ì£¼í”¼í„° DEX ì• ê·¸ë¦¬ê²Œì´í„°',
  'aerodrome slipstream':'ì—ì–´ë¡œë“œë¡¬ Â· Base DEX',
  'sky lending':'ìŠ¤ì¹´ì´ ë Œë”© Â· êµ¬ MakerDAO',
  'hyperliquid spot orderbook':'í•˜ì´í¼ë¦¬í€´ë“œ í˜„ë¬¼ê±°ë˜',
  'uniswap v3':'ìœ ë‹ˆìŠ¤ì™‘ V3 Â· DEX',
  'uniswap v2':'ìœ ë‹ˆìŠ¤ì™‘ V2 Â· DEX',
  'ether.fi liquid':'ì´ë”íŒŒì´ ë¦¬í€´ë“œ ìŠ¤í…Œì´í‚¹',
  'clanker':'í´ë­ì»¤ Â· AI í† í° ëŸ°ì¹˜íŒ¨ë“œ',
  'pancakeswap amm v3':'íŒ¬ì¼€ì´í¬ìŠ¤ì™‘ Â· DEX',
  'pancakeswap amm v2':'íŒ¬ì¼€ì´í¬ìŠ¤ì™‘ V2 Â· DEX',
  'hyperliquid l1':'í•˜ì´í¼ë¦¬í€´ë“œ L1 ì²´ì¸',
  'ore protocol':'ì˜¤ë ˆ í”„ë¡œí† ì½œ',
  'aave v3':'ì•„ë²  V3 Â· ë Œë”©',
  'aave v2':'ì•„ë²  V2 Â· ë Œë”©',
  'aave':'ì•„ë²  Â· ë Œë”©',
  'gmx':'GMX Â· ë¬´ê¸°í•œì„ ë¬¼',
  'gmx v2':'GMX V2 Â· ë¬´ê¸°í•œì„ ë¬¼',
  'raydium':'ë ˆì´ë””ì›€ Â· Solana DEX',
  'lido':'ë¦¬ë„ Â· ë¦¬í€´ë“œ ìŠ¤í…Œì´í‚¹',
  'lido finance':'ë¦¬ë„ Â· ë¦¬í€´ë“œ ìŠ¤í…Œì´í‚¹',
  'compound v3':'ì»´íŒŒìš´ë“œ Â· ë Œë”©',
  'compound':'ì»´íŒŒìš´ë“œ Â· ë Œë”©',
  'maker':'ë©”ì´ì»¤ Â· êµ¬ MakerDAO',
  'sky':'ìŠ¤ì¹´ì´ Â· êµ¬ MakerDAO',
  'curve dex':'ì»¤ë¸Œ Â· ìŠ¤í…Œì´ë¸” DEX',
  'sushiswap':'ìŠ¤ì‹œìŠ¤ì™‘ Â· DEX',
  'sushi':'ìŠ¤ì‹œìŠ¤ì™‘ Â· DEX',
  'trader joe':'íŠ¸ë ˆì´ë”ì¡° Â· DEX',
  'camelot':'ì¹´ë©œë¡¯ Â· Arbitrum DEX',
  'velodrome v2':'ë²¨ë¡œë“œë¡¬ Â· OP DEX',
  'velodrome':'ë²¨ë¡œë“œë¡¬ Â· OP DEX',
  'jito':'ì§€í†  Â· Solana MEV',
  'morpho':'ëª¨í¬ Â· ë Œë”©',
  'fluid':'í”Œë£¨ì´ë“œ Â· ë Œë”©+DEX',
  'ethereum':'ì´ë”ë¦¬ì›€ Â· L1 ì²´ì¸',
  'bitcoin':'ë¹„íŠ¸ì½”ì¸',
  'benqi':'ë²¤ì¹˜ Â· Avalanche ë Œë”©',
  'marinade':'ë§ˆë¦¬ë„¤ì´ë“œ Â· Solana ìŠ¤í…Œì´í‚¹',
  'convex finance':'ì»¨ë²¡ìŠ¤ Â· Curve ë¶€ìŠ¤í„°',
  'pumpswap':'íŒí”„ìŠ¤ì™‘ Â· Pump.fun DEX',
  'orca':'ì˜¤ë¥´ì¹´ Â· Solana DEX',
  'dydx':'dYdX Â· ë¬´ê¸°í•œì„ ë¬¼',
  'drift':'ë“œë¦¬í”„íŠ¸ Â· Solana ë¬´ê¸°í•œì„ ë¬¼',
  'kamino':'ì¹´ë¯¸ë…¸ Â· Solana DeFi',
  'base':'ë² ì´ìŠ¤ Â· L2 ì²´ì¸',
  'solana':'ì†”ë¼ë‚˜ Â· L1 ì²´ì¸',
  'bsc':'ë°”ì´ë‚¸ìŠ¤ ìŠ¤ë§ˆíŠ¸ì²´ì¸',
  'aerodrome':'ì—ì–´ë¡œë“œë¡¬ Â· Base DEX',
  'sparkle':'ìŠ¤íŒŒí´',
  'spark':'ìŠ¤íŒŒí¬ Â· ë Œë”©',
  'pendle':'íœë“¤ Â· ìˆ˜ìµë¥  ê±°ë˜',
  'stargate':'ìŠ¤íƒ€ê²Œì´íŠ¸ Â· í¬ë¡œìŠ¤ì²´ì¸',
  'radiant':'ë ˆì´ë””ì–¸íŠ¸ Â· ë Œë”©',
  'synthetix':'ì‹ ì„¸í‹±ìŠ¤ Â· íŒŒìƒìƒí’ˆ',
  'synapse':'ì‹œëƒ…ìŠ¤ Â· ë¸Œë¦¿ì§€',
  'pancakeswap':'íŒ¬ì¼€ì´í¬ìŠ¤ì™‘ Â· DEX',
  'balancer':'ë°¸ëŸ°ì„œ Â· DEX',
  'frax':'í”„ë™ìŠ¤ Â· ìŠ¤í…Œì´ë¸”ì½”ì¸',
  'thorchain':'í† ë¥´ì²´ì¸ Â· í¬ë¡œìŠ¤ì²´ì¸ DEX',
  'eigenlayer':'ì•„ì´ê²ë ˆì´ì–´ Â· ë¦¬ìŠ¤í…Œì´í‚¹',
  'renzo':'ë Œì¡° Â· ë¦¬ìŠ¤í…Œì´í‚¹',
  'ethena':'ì—í…Œë‚˜ Â· USDe ë°œí–‰',
  'usual':'ìœ ì €ì–¼ Â· RWA',
  'mantle':'ë§¨í‹€ Â· L2 ì²´ì¸',
  'blast':'ë¸”ë˜ìŠ¤íŠ¸ Â· L2 ì²´ì¸',
  'scroll':'ìŠ¤í¬ë¡¤ Â· L2 ì²´ì¸',
  'linea':'ë¦¬ë„¤ì•„ Â· L2 ì²´ì¸',
  'polygon':'í´ë¦¬ê³¤',
  'arbitrum':'ì•„ë¹„íŠ¸ëŸ¼ Â· L2 ì²´ì¸',
  'optimism':'ì˜µí‹°ë¯¸ì¦˜ Â· L2 ì²´ì¸',
  'avalanche':'ì•„ë°œë€ì²´ Â· L1 ì²´ì¸',
  'sui':'ìˆ˜ì´ Â· L1 ì²´ì¸',
  'aptos':'ì•±í† ìŠ¤ Â· L1 ì²´ì¸',
  'near':'ë‹ˆì–´ Â· L1 ì²´ì¸',
};
function getKo(name){
  const n=name.toLowerCase();
  if(KO[n])return KO[n];
  for(const[k,v]of Object.entries(KO)){if(n.includes(k)||k.includes(n))return v}
  return'';
}

// ===== CHAIN COLORS =====
const CC={
  'Ethereum':['#627eea','rgba(98,126,234,.15)'],'Solana':['#00e599','rgba(0,229,153,.15)'],
  'BSC':['#f0b90b','rgba(240,185,11,.15)'],'Arbitrum':['#28a0f0','rgba(40,160,240,.15)'],
  'Base':['#0052ff','rgba(0,82,255,.15)'],'Polygon':['#8247e5','rgba(130,71,229,.15)'],
  'Optimism':['#ff0420','rgba(255,4,32,.15)'],'OP Mainnet':['#ff0420','rgba(255,4,32,.15)'],
  'Avalanche':['#e84142','rgba(232,65,66,.15)'],'Tron':['#eb0029','rgba(235,0,41,.15)'],
  'Sui':['#6fbcf0','rgba(111,188,240,.15)'],'Aptos':['#2ed8a3','rgba(46,216,163,.15)'],
  'Sonic':['#ff6600','rgba(255,102,0,.15)'],
  'Hyperliquid':['#6ee7b7','rgba(110,231,183,.15)'],'Hyperliquid L1':['#6ee7b7','rgba(110,231,183,.15)'],
  'Monad':['#836ef9','rgba(131,110,249,.15)'],'Linea':['#61dfff','rgba(97,223,255,.15)'],
  'Blast':['#fcfc03','rgba(252,252,3,.15)'],
  'zkSync Era':['#8c8dfc','rgba(140,141,252,.15)'],'ZKsync Era':['#8c8dfc','rgba(140,141,252,.15)'],
  'Bitcoin':['#f7931a','rgba(247,147,26,.15)'],'Berachain':['#f5a623','rgba(245,166,35,.15)'],
  'TON':['#0098ea','rgba(0,152,234,.15)'],'Near':['#00ec97','rgba(0,236,151,.15)'],
  'Starknet':['#ec796b','rgba(236,121,107,.15)'],'Plasma':['#44e55c','rgba(68,229,92,.15)'],
  'Mantle':['#9aa0a6','rgba(154,160,166,.15)'],'Scroll':['#ffeeda','rgba(255,238,218,.15)'],
  'Cronos':['#4169e1','rgba(65,105,225,.15)'],'Fantom':['#1969ff','rgba(25,105,255,.15)'],
  'Sei':['#e14c4c','rgba(225,76,76,.15)'],'Injective':['#00f2fe','rgba(0,242,254,.15)'],
  'Mode':['#dffe00','rgba(223,254,0,.15)'],'Gnosis':['#3e6957','rgba(62,105,87,.15)'],
  'Kaia':['#ff3d00','rgba(255,61,0,.15)'],'Multi':['#888','rgba(136,136,136,.15)'],
};
function gc(c){
  if(CC[c])return{color:CC[c][0],bg:CC[c][1]};
  let h=0;for(let i=0;i<c.length;i++)h=c.charCodeAt(i)+((h<<5)-h);
  const hu=Math.abs(h)%360,s=60+(Math.abs(h>>8)%20),l=55+(Math.abs(h>>16)%15);
  const co=`hsl(${hu},${s}%,${l}%)`,bg=`hsla(${hu},${s}%,${l}%,.15)`;
  CC[c]=[co,bg];return{color:co,bg};
}

// ===== METHODS =====
const MT={
  'pump.fun':'burn','pump':'burn','pumpswap':'burn',
  'hyperliquid perps':'burn','hyperliquid':'burn','hyperliquid spot orderbook':'burn','hyperliquid l1':'burn',
  'ethereum':'burn','tron':'burn','bitcoin':'burn','solana':'burn',
  'makerdao':'burn','maker':'burn','sky':'burn','sky lending':'burn',
  'raydium':'burn','orca':'burn',
  'jupiter':'burn','jupiter perpetual exchange':'burn','jupiter aggregator':'burn','jupiter dca':'burn',
  'aerodrome':'stake','aerodrome slipstream':'stake',
  'velodrome v2':'stake','velodrome':'stake',
  'aave':'stake','aave v3':'stake','aave v2':'stake',
  'curve dex':'stake','curve finance':'stake','convex finance':'stake',
  'gmx':'stake','gmx v2':'stake',
  'uniswap v3':'dist','uniswap':'dist','uniswap v2':'dist',
  'sushi':'burn','sushiswap':'burn',
  'lido':'dist','lido finance':'dist',
  'compound':'dist','compound v3':'dist',
  'yield basis':'burn',
  'pancakeswap amm v3':'burn','pancakeswap amm v2':'burn','pancakeswap':'burn',
  'morpho':'dist','fluid':'dist',
  'jito':'stake','marinade':'stake','benqi':'stake',
  'trader joe':'burn','camelot':'stake',
  'clanker':'burn','ether.fi liquid':'stake',
  'ore protocol':'burn','dydx':'stake','drift':'stake',
  'pendle':'dist','stargate':'burn',
  'synthetix':'burn','balancer':'dist',
  'thorchain':'burn','eigenlayer':'stake',
  'ethena':'burn','spark':'dist',
};
function gm(n){const l=n.toLowerCase();if(MT[l])return MT[l];for(const[k,v]of Object.entries(MT)){if(l.includes(k)||k.includes(l))return v}return null}
function ml(m){
  if(m==='burn')return{i:'ğŸ”¥',t:'ì†Œê°',c:'mb-burn'};
  if(m==='stake')return{i:'ğŸ’',t:'ìŠ¤í…Œì´í‚¹',c:'mb-stake'};
  if(m==='dist')return{i:'ğŸ’¸',t:'ë°°ë¶„',c:'mb-dist'};
  return{i:'',t:'-',c:''};
}
function mdc(m){return m==='burn'?'var(--red)':m==='stake'?'var(--pur)':m==='dist'?'var(--cyn)':'var(--t3)'}

// ===== STATE =====
let cP='24h',cD=null,cS={key:'holdersRevenue',dir:'desc'};
function fC(v){if(v==null||isNaN(v))return'-';if(Math.abs(v)>=1e9)return'$'+(v/1e9).toFixed(2)+'B';if(Math.abs(v)>=1e6)return'$'+(v/1e6).toFixed(2)+'M';if(Math.abs(v)>=1e3)return'$'+(v/1e3).toFixed(1)+'K';return'$'+v.toFixed(0)}
function fP(v){return(v==null||isNaN(v))?'-':v.toFixed(1)+'%'}
function pk(){return cP==='24h'?'total24h':cP==='7d'?'total7d':'total30d'}

function chgP(p){
  cP=p;
  document.querySelectorAll('.pbtn').forEach(b=>b.classList.remove('on'));
  document.querySelector(`[data-p="${p}"]`).classList.add('on');
  if(cD)renderAll(cD);
}
function togDet(){
  const d=document.getElementById('infoDet'),i=document.getElementById('togIc');
  d.classList.toggle('show');i.textContent=d.classList.contains('show')?'â–¼':'â–¶';
}

// ===== FETCH =====
async function fetchData(){
  try{
    const[fR,hR,rR]=await Promise.all([
      fetch('https://api.llama.fi/overview/fees'),
      fetch('https://api.llama.fi/overview/fees?dataType=dailyHoldersRevenue'),
      fetch('https://api.llama.fi/overview/fees?dataType=dailyRevenue')
    ]);
    if(!fR.ok||!hR.ok||!rR.ok)throw new Error('err');
    cD={f:await fR.json(),h:await hR.json(),r:await rR.json()};
    document.getElementById('sDot').classList.remove('err');
    renderAll(cD);
  }catch(e){
    console.error(e);
    document.getElementById('sDot').classList.add('err');
    document.getElementById('uTime').textContent='ì—°ê²° ì‹¤íŒ¨';
    showErr();
  }
}
function showErr(){
  document.getElementById('barChart').innerHTML=`<div class="err-box"><div class="err-ic">âš ï¸</div><div class="err-txt">API ì—°ê²° ì‹¤íŒ¨</div><div class="err-sub">GitHub Pagesì— ë°°í¬í•˜ë©´ ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤</div><button class="retry" onclick="fetchData()">ë‹¤ì‹œ ì‹œë„</button></div>`;
  document.getElementById('pGrid').innerHTML='';
  document.getElementById('tBody').innerHTML='<tr><td colspan="8" style="text-align:center;padding:30px;color:var(--t3)">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</td></tr>';
}

// ===== RENDER =====
function renderAll(d){
  const k=pk(),hM={},rM={};
  (d.h.protocols||[]).forEach(h=>{hM[h.name]=h});
  (d.r.protocols||[]).forEach(r=>{rM[r.name]=r});

  const protos=(d.f.protocols||[]).map(p=>{
    const hm=hM[p.name],rm=rM[p.name];
    const hr=hm?(hm[k]||0):0,rev=rm?(rm[k]||0):0,fees=p[k]||0;
    const at=hm?(hm.totalAllTime||0):0;
    return{
      name:p.name||'?',chains:p.chains||[],
      chain:(p.chains&&p.chains[0])||'Multi',
      category:p.category||'-',
      fees,revenue:rev,holdersRevenue:hr,allTime:at,
      ratio:rev>0?(hr/rev*100):0,
      method:gm(p.name||''),
      ko:getKo(p.name||'')
    };
  }).filter(p=>p.holdersRevenue>0);

  const tHR=protos.reduce((s,p)=>s+p.holdersRevenue,0);
  const tRev=protos.reduce((s,p)=>s+p.revenue,0);

  document.getElementById('sHR').textContent=fC(tHR);
  document.getElementById('sHRs').textContent=`ë°”ì´ë°± í•©ê³„ (${cP})`;
  document.getElementById('sRev').textContent=fC(tRev);
  document.getElementById('sRevs').textContent=`í”„ë¡œí† ì½œ ìˆ˜ìµ (${cP})`;
  document.getElementById('sRat').textContent=fP(tRev>0?tHR/tRev*100:0);
  document.getElementById('sCnt').textContent=protos.length;
  document.getElementById('sCnts').textContent=`ë°”ì´ë°± í”„ë¡œí† ì½œ (${cP})`;

  const now=new Date();
  document.getElementById('uTime').textContent=`${now.getMonth()+1}/${now.getDate()} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;

  const sorted=[...protos].sort((a,b)=>b.holdersRevenue-a.holdersRevenue);
  renderBar(sorted.slice(0,15));
  renderCards(sorted.slice(0,10));
  renderTable(protos);
  sendH();
}

function renderBar(list){
  if(!list.length){document.getElementById('barChart').innerHTML='<div style="text-align:center;padding:40px;color:var(--t3)">ë°ì´í„° ì—†ìŒ</div>';return}
  const mx=list[0].holdersRevenue;
  document.getElementById('barChart').innerHTML=list.map(p=>{
    const cc=gc(p.chain),pct=mx>0?(p.holdersRevenue/mx*100):0,md=mdc(p.method);
    return`<div class="brow">
      <div class="brow-top">
        <div class="brow-name-area">
          <div class="brow-ci" style="background:${cc.bg};color:${cc.color}">${p.chain.charAt(0)}</div>
          <span class="brow-mdot" style="background:${md}"></span>
          <div class="brow-names">
            <span class="brow-name">${p.name}</span>
            ${p.ko?`<span class="brow-ko">${p.ko}</span>`:''}
          </div>
        </div>
        <div class="brow-val mono" style="color:${cc.color}">${fC(p.holdersRevenue)}</div>
      </div>
      <div class="brow-bar"><div class="brow-fill" style="width:0%;background:linear-gradient(90deg,${cc.color},${cc.color}99)" data-w="${pct}"></div></div>
    </div>`;
  }).join('');
  requestAnimationFrame(()=>{setTimeout(()=>{document.querySelectorAll('.brow-fill').forEach(el=>{el.style.width=el.dataset.w+'%'})},50)});
}

function renderCards(list){
  document.getElementById('pGrid').innerHTML=list.map((p,i)=>{
    const cc=gc(p.chain),m=p.method?ml(p.method):null;
    const r=p.ratio,rc=r>50?'var(--grn)':r>20?'var(--org)':'var(--t2)';
    const cbs=(p.chains.length>0?p.chains.slice(0,2):[p.chain]).map(c=>{
      const x=gc(c);return`<span class="cbadge" style="color:${x.color};border-color:${x.color}30"><span class="cbadge-ic" style="background:${x.bg};color:${x.color}">${c.charAt(0)}</span>${c}</span>`;
    }).join('');
    return`<div class="pcard">
      <div class="pc-top">
        <div class="pc-left">
          <span class="pc-rank ${i<3?'t3':''}">${i+1}</span>
          <div class="pc-ncol">
            <div class="pc-name">${p.name}</div>
            ${p.ko?`<div class="pc-ko">${p.ko}</div>`:''}
            <div class="pc-cat">${p.category}</div>
          </div>
        </div>
        <div class="pc-badges">
          ${m?`<span class="mbadge ${m.c}">${m.i} ${m.t}${r>=95?' 100%':''}</span>`:''}
        </div>
      </div>
      <div style="display:flex;gap:4px;flex-wrap:wrap">${cbs}</div>
      <div>
        <div class="pc-amt">${fC(p.holdersRevenue)}</div>
        ${p.allTime>0?`<div class="pc-amt-sub">ëˆ„ì  ë°”ì´ë°±: ${fC(p.allTime)}</div>`:''}
      </div>
      <div class="pc-metrics">
        <div class="pc-m"><div class="pc-ml">Revenue</div><div class="pc-mv">${fC(p.revenue)}</div></div>
        <div class="pc-m"><div class="pc-ml">Fees</div><div class="pc-mv">${fC(p.fees)}</div></div>
        <div class="pc-m"><div class="pc-ml">ë°”ì´ë°± ë¹„ìœ¨</div><div class="pc-mv" style="color:${rc}">${fP(r)}</div></div>
      </div>
      <div class="pc-ratio">
        <div class="pc-rh"><span class="pc-rl">Revenue â†’ ë³´ìœ ì í™˜ì›</span><span class="pc-rv" style="color:${rc}">${fP(r)}</span></div>
        <div class="pc-rt"><div class="pc-rf" style="width:${Math.min(r,100)}%;background:${rc}"></div></div>
      </div>
    </div>`;
  }).join('');
}

function renderTable(protos){
  const sorted=[...protos].sort((a,b)=>{
    const d=cS.dir==='desc'?-1:1,k=cS.key;
    if(k==='name'||k==='chain'||k==='category')return d*-1*(a[k]||'').localeCompare(b[k]||'');
    return d*((b[k]||0)-(a[k]||0));
  }).slice(0,30);
  document.getElementById('tBody').innerHTML=sorted.map((p,i)=>{
    const cc=gc(p.chain),m=p.method?ml(p.method):null;
    const rc=p.ratio>50?'var(--grn)':p.ratio>20?'var(--org)':'var(--t2)';
    return`<tr>
      <td class="mono" style="color:var(--t3)">${i+1}</td>
      <td><div class="td-name"><span style="font-weight:500">${p.name}</span>${p.ko?`<span class="td-ko">${p.ko}</span>`:''}</div></td>
      <td><span class="td-cb" style="border-color:${cc.color}40;color:${cc.color}">${p.chain}</span></td>
      <td>${m?`<span class="td-mb ${m.c}">${m.i}${m.t}</span>`:'-'}</td>
      <td class="mono" style="font-weight:600;color:var(--grn)">${fC(p.holdersRevenue)}</td>
      <td class="mono">${fC(p.revenue)}</td>
      <td class="mono" style="color:${rc}">${fP(p.ratio)}</td>
      <td class="mono" style="color:var(--t2)">${p.allTime>0?fC(p.allTime):'-'}</td>
    </tr>`;
  }).join('');
}

function srt(key){
  if(cS.key===key)cS.dir=cS.dir==='desc'?'asc':'desc';
  else cS={key,dir:'desc'};
  document.querySelectorAll('thead th').forEach(th=>th.classList.remove('sorted'));
  if(cD)renderAll(cD);
}

// ===== IMWEB IFRAME AUTO-HEIGHT =====
function sendH(){
  try{
    const h=document.documentElement.scrollHeight;
    window.parent.postMessage({type:'resize',height:h},'*');
    window.parent.postMessage(JSON.stringify({type:'resize',height:h}),'*');
    if(window.frameElement){
      window.frameElement.style.height=h+'px';
      window.frameElement.style.overflow='visible';
    }
  }catch(e){}
}
if(window!==window.top){document.body.classList.add('in-iframe')}
window.addEventListener('resize',()=>{clearTimeout(window._rto);window._rto=setTimeout(()=>{if(cD)sendH()},150)});
new MutationObserver(()=>{sendH()}).observe(document.body,{childList:true,subtree:true});

fetchData();
</script>
</body>
</html>
