<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í¬ë¦½í†  ë°”ì´ë°± ëŒ€ì‹œë³´ë“œ | Protocol Buyback Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-primary: #0a0a0f;
  --bg-card: #16161f;
  --bg-card-hover: #1c1c28;
  --border: #2a2a3a;
  --border-light: #353545;
  --text-primary: #e8e8f0;
  --text-secondary: #8888a0;
  --text-muted: #555570;
  --accent-green: #00e599;
  --accent-green-dim: rgba(0,229,153,0.15);
  --accent-blue: #3b82f6;
  --accent-blue-dim: rgba(59,130,246,0.15);
  --accent-purple: #a855f7;
  --accent-purple-dim: rgba(168,85,247,0.15);
  --accent-orange: #f59e0b;
  --accent-orange-dim: rgba(245,158,11,0.15);
  --accent-red: #ef4444;
  --accent-red-dim: rgba(239,68,68,0.15);
  --accent-cyan: #06b6d4;
  --accent-cyan-dim: rgba(6,182,212,0.15);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Outfit',sans-serif;background:var(--bg-primary);color:var(--text-primary);min-height:100vh;overflow-x:hidden}
.mono{font-family:'JetBrains Mono',monospace}

/* ===== HEADER ===== */
.header{padding:24px 28px 20px;border-bottom:1px solid var(--border);background:linear-gradient(180deg,rgba(0,229,153,0.03) 0%,transparent 100%)}
.header-top{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
.header-left{display:flex;align-items:center;gap:14px}
.logo-icon{width:38px;height:38px;background:linear-gradient(135deg,var(--accent-green),#00b377);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:800;color:#0a0a0f;letter-spacing:-1px}
.header h1{font-size:22px;font-weight:700;background:linear-gradient(135deg,var(--text-primary),var(--accent-green));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.header-subtitle{font-size:12px;color:var(--text-muted);margin-top:2px;letter-spacing:0.5px}
.header-right{display:flex;align-items:center;gap:10px}
.update-badge{display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--bg-card);border:1px solid var(--border);border-radius:8px;font-size:11px;color:var(--text-secondary)}
.update-dot{width:6px;height:6px;background:var(--accent-green);border-radius:50%;animation:pulse 2s infinite}
.update-dot.error{background:var(--accent-red)}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.3}}
.period-selector{display:flex;background:var(--bg-card);border:1px solid var(--border);border-radius:8px;overflow:hidden}
.period-btn{padding:6px 14px;font-size:12px;font-weight:500;background:transparent;color:var(--text-secondary);border:none;cursor:pointer;transition:all 0.2s;font-family:'Outfit',sans-serif}
.period-btn.active{background:var(--accent-green);color:#0a0a0f;font-weight:600}
.period-btn:hover:not(.active){color:var(--text-primary);background:var(--bg-card-hover)}

/* ===== INFO BANNER ===== */
.info-banner{margin:20px 28px 0;background:linear-gradient(135deg,rgba(0,229,153,0.06),rgba(59,130,246,0.04));border:1px solid rgba(0,229,153,0.15);border-radius:12px;padding:18px 20px}
.info-banner-title{font-size:14px;font-weight:600;color:var(--accent-green);margin-bottom:10px;display:flex;align-items:center;gap:8px}
.info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
.info-item{display:flex;gap:10px;align-items:flex-start}
.info-icon{width:28px;height:28px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0;margin-top:1px}
.info-item-label{font-size:12px;font-weight:600;color:var(--text-primary);margin-bottom:2px}
.info-item-desc{font-size:11px;color:var(--text-secondary);line-height:1.5}
.info-toggle{display:flex;align-items:center;gap:6px;background:none;border:none;color:var(--accent-green);font-size:12px;font-weight:500;cursor:pointer;font-family:'Outfit',sans-serif;padding:0;margin-top:12px}
.info-toggle:hover{text-decoration:underline}
.info-detail{display:none;margin-top:14px;padding-top:14px;border-top:1px solid rgba(0,229,153,0.1)}
.info-detail.show{display:block}
.info-detail-text{font-size:12px;color:var(--text-secondary);line-height:1.7}
.info-detail-text strong{color:var(--text-primary);font-weight:600}
.info-highlight{display:inline-block;background:var(--accent-green-dim);color:var(--accent-green);padding:1px 6px;border-radius:4px;font-size:11px;font-weight:500}
.trad-compare{display:grid;grid-template-columns:1fr auto 1fr;gap:12px;margin-top:12px;align-items:center}
.trad-compare-box{background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:10px 14px;text-align:center}
.trad-compare-box .label{font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px}
.trad-compare-box .value{font-size:12px;font-weight:600}
.trad-compare-arrow{font-size:16px;color:var(--text-muted);text-align:center}

/* ===== SUMMARY ===== */
.summary-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;padding:20px 28px}
.summary-card{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:16px 18px;transition:all 0.3s}
.summary-card:hover{border-color:var(--border-light);transform:translateY(-1px)}
.summary-label{font-size:11px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.8px;margin-bottom:8px;display:flex;align-items:center;gap:6px}
.tooltip-trigger{display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;border-radius:50%;background:var(--bg-primary);border:1px solid var(--border);font-size:9px;color:var(--text-muted);cursor:help;position:relative}
.tooltip-trigger:hover .tooltip-box{display:block}
.tooltip-box{display:none;position:absolute;top:100%;left:50%;transform:translateX(-50%);margin-top:6px;background:#22222e;border:1px solid var(--border-light);border-radius:8px;padding:10px 12px;font-size:11px;color:var(--text-secondary);line-height:1.5;width:220px;z-index:100;font-weight:400;text-transform:none;letter-spacing:0;box-shadow:0 8px 24px rgba(0,0,0,0.4)}
.tooltip-box::before{content:'';position:absolute;top:-5px;left:50%;transform:translateX(-50%) rotate(45deg);width:8px;height:8px;background:#22222e;border-left:1px solid var(--border-light);border-top:1px solid var(--border-light)}
.summary-value{font-size:24px;font-weight:700;letter-spacing:-0.5px}
.summary-sub{font-size:11px;color:var(--text-secondary);margin-top:4px}

/* ===== MAIN ===== */
.main-content{padding:0 28px 28px}
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;flex-wrap:wrap;gap:8px}
.section-title{font-size:15px;font-weight:600;color:var(--text-primary);display:flex;align-items:center;gap:8px}
.section-title .icon{font-size:16px}
.section-desc{font-size:11px;color:var(--text-muted)}

/* ===== BAR CHART ===== */
.chart-section{margin-bottom:24px}
.chart-container{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:20px}
.bar-chart{display:flex;flex-direction:column;gap:8px}
.bar-row{display:grid;grid-template-columns:160px 1fr 90px;align-items:center;gap:12px;padding:5px 8px;border-radius:8px;transition:all 0.2s}
.bar-row:hover{background:rgba(255,255,255,0.02)}
.bar-proto-name{font-size:13px;font-weight:500;display:flex;align-items:center;gap:8px;white-space:nowrap;overflow:hidden}
.bar-chain-icon{width:18px;height:18px;border-radius:5px;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;flex-shrink:0}
.bar-method-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.bar-track{height:26px;background:rgba(255,255,255,0.03);border-radius:6px;overflow:hidden}
.bar-fill{height:100%;border-radius:6px;transition:width 0.8s cubic-bezier(0.25,0.46,0.45,0.94);min-width:2px}
.bar-value{font-size:13px;font-weight:600;text-align:right;white-space:nowrap}

/* ===== PROTOCOL CARDS ===== */
.proto-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:14px;margin-bottom:24px}
.proto-card{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:18px;transition:all 0.3s;display:flex;flex-direction:column;gap:12px}
.proto-card:hover{border-color:var(--border-light);transform:translateY(-2px);box-shadow:0 8px 32px rgba(0,0,0,0.3)}
.proto-card-top{display:flex;align-items:center;justify-content:space-between;gap:8px}
.proto-card-left{display:flex;align-items:center;gap:10px;min-width:0}
.proto-rank{font-size:18px;font-weight:800;color:var(--text-muted);width:28px;text-align:center;flex-shrink:0}
.proto-rank.top3{color:var(--accent-green)}
.proto-name-col{min-width:0}
.proto-name{font-size:15px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.proto-category{font-size:10px;color:var(--text-muted);margin-top:1px}
.proto-badges{display:flex;gap:5px;flex-shrink:0;flex-wrap:wrap}
.chain-badge{display:flex;align-items:center;gap:4px;padding:3px 8px;border-radius:6px;font-size:10px;font-weight:500;border:1px solid}
.chain-badge-icon{width:14px;height:14px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:700}
.method-badge{padding:3px 8px;border-radius:6px;font-size:10px;font-weight:600;display:flex;align-items:center;gap:4px}
.method-burn{background:var(--accent-red-dim);color:var(--accent-red)}
.method-stake{background:var(--accent-purple-dim);color:var(--accent-purple)}
.method-dist{background:var(--accent-cyan-dim);color:var(--accent-cyan)}
.method-mixed{background:var(--accent-orange-dim);color:var(--accent-orange)}

.proto-amount{font-size:22px;font-weight:700;color:var(--accent-green);letter-spacing:-0.5px}
.proto-amount-sub{font-size:11px;color:var(--text-muted);margin-top:2px}

.proto-metrics{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}
.proto-metric{padding:8px 10px;background:var(--bg-primary);border-radius:8px}
.proto-metric-label{font-size:9px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:3px}
.proto-metric-value{font-size:14px;font-weight:600}
.proto-metric-sub{font-size:9px;color:var(--text-secondary);margin-top:1px}

.proto-ratio{padding:8px 10px;background:var(--bg-primary);border-radius:8px}
.proto-ratio-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}
.proto-ratio-label{font-size:9px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px}
.proto-ratio-val{font-size:12px;font-weight:600}
.proto-ratio-track{height:5px;background:rgba(255,255,255,0.05);border-radius:3px;overflow:hidden}
.proto-ratio-fill{height:100%;border-radius:3px;transition:width 0.6s ease}

/* ===== TABLE ===== */
.table-section{margin-bottom:24px}
.table-container{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;overflow:hidden}
.table-scroll{overflow-x:auto}
table{width:100%;border-collapse:collapse;min-width:800px}
thead th{padding:12px 14px;font-size:10px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.8px;text-align:left;border-bottom:1px solid var(--border);background:rgba(255,255,255,0.01);white-space:nowrap;cursor:pointer;user-select:none;transition:color 0.2s}
thead th:hover{color:var(--text-secondary)}
thead th.sorted{color:var(--accent-green)}
tbody tr{transition:background 0.15s}
tbody tr:hover{background:rgba(255,255,255,0.02)}
tbody td{padding:10px 14px;font-size:13px;border-bottom:1px solid rgba(255,255,255,0.03);white-space:nowrap}
.td-chain-badge{font-size:9px;padding:2px 6px;border-radius:4px;background:var(--bg-primary);border:1px solid var(--border)}
.td-method{font-size:9px;padding:2px 6px;border-radius:4px;font-weight:600}

/* ===== LOADING / ERROR ===== */
.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 20px;gap:16px}
.loading-spinner{width:36px;height:36px;border:3px solid var(--border);border-top-color:var(--accent-green);border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{font-size:13px;color:var(--text-secondary)}
.error-container{text-align:center;padding:60px 20px}
.error-icon{font-size:36px;margin-bottom:12px}
.error-text{font-size:14px;color:var(--text-secondary);margin-bottom:8px}
.error-sub{font-size:12px;color:var(--text-muted);margin-bottom:16px}
.retry-btn{padding:8px 20px;background:var(--accent-green);color:#0a0a0f;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;font-family:'Outfit',sans-serif;transition:opacity 0.2s}
.retry-btn:hover{opacity:0.85}

/* ===== FOOTER ===== */
.footer{padding:16px 28px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}
.footer-text{font-size:11px;color:var(--text-muted)}
.footer-link{color:var(--accent-green);text-decoration:none}
.footer-link:hover{text-decoration:underline}

/* ===== RESPONSIVE ===== */
@media(max-width:768px){
  .header{padding:16px}
  .header h1{font-size:18px}
  .info-banner{margin:12px 16px 0;padding:14px 16px}
  .info-grid{grid-template-columns:1fr}
  .trad-compare{grid-template-columns:1fr;gap:6px}
  .trad-compare-arrow{transform:rotate(90deg)}
  .summary-row{padding:12px 16px;gap:8px}
  .summary-value{font-size:20px}
  .main-content{padding:0 16px 16px}
  .proto-grid{grid-template-columns:1fr}
  .bar-row{grid-template-columns:130px 1fr 80px;gap:8px}
  .bar-proto-name{font-size:12px}
  .footer{padding:12px 16px}
  .period-selector{order:3}
  .proto-metrics{grid-template-columns:1fr 1fr}
}
@media(max-width:480px){
  .summary-row{grid-template-columns:1fr 1fr}
  .header-top{flex-direction:column;align-items:flex-start}
}
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--border-light)}
</style>
</head>
<body>

<!-- ===== HEADER ===== -->
<div class="header">
  <div class="header-top">
    <div class="header-left">
      <div class="logo-icon">BB</div>
      <div>
        <h1>í¬ë¦½í†  ë°”ì´ë°± ëŒ€ì‹œë³´ë“œ</h1>
        <div class="header-subtitle">PROTOCOL BUYBACK & TOKEN HOLDER REVENUE TRACKER</div>
      </div>
    </div>
    <div class="header-right">
      <div class="update-badge">
        <span class="update-dot" id="statusDot"></span>
        <span id="updateTime">ë¡œë”© ì¤‘...</span>
      </div>
      <div class="period-selector">
        <button class="period-btn active" data-period="24h" onclick="changePeriod('24h')">24H</button>
        <button class="period-btn" data-period="7d" onclick="changePeriod('7d')">7D</button>
        <button class="period-btn" data-period="30d" onclick="changePeriod('30d')">30D</button>
      </div>
    </div>
  </div>
</div>

<!-- ===== EXPLANATION ===== -->
<div class="info-banner">
  <div class="info-banner-title">ğŸ’¡ í¬ë¦½í†  ë°”ì´ë°±ì´ë€?</div>
  <div class="info-grid">
    <div class="info-item">
      <div class="info-icon" style="background:var(--accent-green-dim);color:var(--accent-green)">ğŸ’°</div>
      <div>
        <div class="info-item-label">Holders Revenue (í™€ë” ìˆ˜ìµ)</div>
        <div class="info-item-desc">í”„ë¡œí† ì½œ ìˆ˜ìµ ì¤‘ <strong>í† í° ë³´ìœ ìì—ê²Œ ëŒë ¤ì£¼ëŠ” ê¸ˆì•¡</strong>. ì£¼ì‹ì˜ ë°°ë‹¹ê¸ˆ + ìì‚¬ì£¼ë§¤ì…ê³¼ ê°™ì€ ê°œë….</div>
      </div>
    </div>
    <div class="info-item">
      <div class="info-icon" style="background:var(--accent-red-dim);color:var(--accent-red)">ğŸ”¥</div>
      <div>
        <div class="info-item-label">ë°”ì´ë°± ë°©ì‹</div>
        <div class="info-item-desc"><strong>ğŸ”¥ ì†Œê°</strong> = í† í° ë§¤ì… í›„ ì˜êµ¬ ì‚­ì œ (ê³µê¸‰â†“) Â· <strong>ğŸ’ ìŠ¤í…Œì´í‚¹</strong> = ë³´ìœ ìì—ê²Œ ë³´ìƒ Â· <strong>ğŸ’¸ ì§ì ‘ë°°ë¶„</strong> = ìˆ˜ìµ ë¶„ë°°</div>
      </div>
    </div>
    <div class="info-item">
      <div class="info-icon" style="background:var(--accent-purple-dim);color:var(--accent-purple)">ğŸ“Š</div>
      <div>
        <div class="info-item-label">ë°”ì´ë°± ë¹„ìœ¨</div>
        <div class="info-item-desc">Revenue ëŒ€ë¹„ Holders Revenue ë¹„ìœ¨. <strong>ë†’ì„ìˆ˜ë¡ íˆ¬ìì í™˜ì›ì— ì ê·¹ì </strong>. ì£¼ì£¼í™˜ì›ìœ¨ê³¼ ìœ ì‚¬.</div>
      </div>
    </div>
  </div>
  <button class="info-toggle" onclick="toggleDetail()"><span id="toggleIcon">â–¶</span> ì£¼ì‹ íˆ¬ììë¥¼ ìœ„í•œ ìƒì„¸ ë¹„êµ ë³´ê¸°</button>
  <div class="info-detail" id="infoDetail">
    <div class="trad-compare">
      <div class="trad-compare-box"><div class="label">ğŸ¢ ì£¼ì‹ (TradFi)</div><div class="value" style="color:var(--accent-blue)">ë§¤ì¶œ â†’ ì˜ì—…ì´ìµ â†’ ë°°ë‹¹ + ìì‚¬ì£¼ë§¤ì…</div></div>
      <div class="trad-compare-arrow">â‰ˆ</div>
      <div class="trad-compare-box"><div class="label">â›“ï¸ í¬ë¦½í†  (DeFi)</div><div class="value" style="color:var(--accent-green)">Fees â†’ Revenue â†’ Holders Revenue</div></div>
    </div>
    <div class="info-detail-text" style="margin-top:14px">
      <strong>Fees</strong> = ì‚¬ìš©ì ìˆ˜ìˆ˜ë£Œ â†’ <span class="info-highlight">ë§¤ì¶œì•¡</span> Â· <strong>Revenue</strong> = í”„ë¡œí† ì½œ ìˆ˜ìµ â†’ <span class="info-highlight">ì˜ì—…ì´ìµ</span> Â· <strong>Holders Revenue</strong> = í† í° ë³´ìœ ì í™˜ì› â†’ <span class="info-highlight">ë°°ë‹¹+ìì‚¬ì£¼ë§¤ì…</span><br><br>
      ğŸ”¥ <strong>ëŒ€í‘œ ì‚¬ë¡€ â€” Pump.fun:</strong> Revenue <span class="info-highlight">100%</span>ë¥¼ ë§¤ì¼ PUMP í† í° ë°”ì´ë°±ì— ì‚¬ìš©. ëˆ„ì  $98M+ ë°”ì´ë°±, ìœ í†µëŸ‰ 6.7% ê°ì†Œ.
    </div>
  </div>
</div>

<!-- ===== SUMMARY ===== -->
<div class="summary-row">
  <div class="summary-card">
    <div class="summary-label">ì „ì²´ Holders Revenue <span class="tooltip-trigger">?<div class="tooltip-box">ì „ì²´ í”„ë¡œí† ì½œì—ì„œ í† í° ë³´ìœ ìì—ê²Œ í™˜ì›ëœ ì´ ê¸ˆì•¡.</div></span></div>
    <div class="summary-value" id="totalHR">-</div>
    <div class="summary-sub" id="totalHRSub">ë°”ì´ë°±+ì†Œê°+ìŠ¤í…Œì´í‚¹ ë°°ë¶„</div>
  </div>
  <div class="summary-card">
    <div class="summary-label">ì „ì²´ Revenue <span class="tooltip-trigger">?<div class="tooltip-box">í”„ë¡œí† ì½œë“¤ì˜ ìì²´ ìˆ˜ìµ í•©ê³„. ì£¼ì‹ì˜ ì˜ì—…ì´ìµê³¼ ìœ ì‚¬.</div></span></div>
    <div class="summary-value" id="totalRev">-</div>
    <div class="summary-sub" id="totalRevSub">í”„ë¡œí† ì½œ ìˆ˜ìµ í•©ê³„</div>
  </div>
  <div class="summary-card">
    <div class="summary-label">ë°”ì´ë°± ë¹„ìœ¨ <span class="tooltip-trigger">?<div class="tooltip-box">Revenue ì¤‘ ë³´ìœ ìì—ê²Œ í™˜ì›ëœ ë¹„ìœ¨. ì£¼ì£¼í™˜ì›ìœ¨ê³¼ ë™ì¼ ê°œë….</div></span></div>
    <div class="summary-value" id="totalRatio">-</div>
    <div class="summary-sub">Holders Revenue Ã· Revenue</div>
  </div>
  <div class="summary-card">
    <div class="summary-label">ë°”ì´ë°± í”„ë¡œí† ì½œ ìˆ˜ <span class="tooltip-trigger">?<div class="tooltip-box">Holders Revenueê°€ ì¡´ì¬í•˜ëŠ” í”„ë¡œí† ì½œ ìˆ˜.</div></span></div>
    <div class="summary-value" id="totalCount">-</div>
    <div class="summary-sub" id="totalCountSub">Holders Revenue ì¡´ì¬</div>
  </div>
</div>

<div class="main-content">
  <!-- ===== BAR CHART ===== -->
  <div class="chart-section">
    <div class="section-header">
      <div>
        <div class="section-title"><span class="icon">ğŸ“Š</span> í”„ë¡œí† ì½œë³„ ë°”ì´ë°±(Holders Revenue) TOP 15</div>
        <div class="section-desc">í† í° ë³´ìœ ìì—ê²Œ í™˜ì›í•œ ê¸ˆì•¡ ê¸°ì¤€ ìƒìœ„ í”„ë¡œí† ì½œ</div>
      </div>
    </div>
    <div class="chart-container">
      <div class="bar-chart" id="barChart">
        <div class="loading-container"><div class="loading-spinner"></div><div class="loading-text">DefiLlama APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div></div>
      </div>
    </div>
  </div>

  <!-- ===== PROTOCOL CARDS ===== -->
  <div class="section-header">
    <div>
      <div class="section-title"><span class="icon">ğŸ”¥</span> ë°”ì´ë°± í”„ë¡œí† ì½œ ìƒì„¸ TOP 10</div>
      <div class="section-desc">ë°”ì´ë°± ë°©ì‹ Â· ì²´ì¸ Â· ëˆ„ì  ë°”ì´ë°± Â· ë¹„ìœ¨ ë¶„ì„</div>
    </div>
  </div>
  <div class="proto-grid" id="protoGrid"></div>

  <!-- ===== TABLE ===== -->
  <div class="table-section">
    <div class="section-header">
      <div>
        <div class="section-title"><span class="icon">ğŸ†</span> ì „ì²´ ë°”ì´ë°± í”„ë¡œí† ì½œ ëª©ë¡</div>
        <div class="section-desc">ì—´ í´ë¦­ ì‹œ ì •ë ¬ Â· Holders Revenue ê¸°ì¤€</div>
      </div>
    </div>
    <div class="table-container">
      <div class="table-scroll">
        <table>
          <thead><tr>
            <th onclick="sortTable('rank')">#</th>
            <th onclick="sortTable('name')">í”„ë¡œí† ì½œ</th>
            <th onclick="sortTable('chain')">ì²´ì¸</th>
            <th onclick="sortTable('category')">ì¹´í…Œê³ ë¦¬</th>
            <th>ë°©ì‹</th>
            <th onclick="sortTable('holdersRevenue')" class="sorted">Holders Rev. â–¼</th>
            <th onclick="sortTable('revenue')">Revenue</th>
            <th onclick="sortTable('fees')">Fees</th>
            <th onclick="sortTable('ratio')">ë°”ì´ë°± ë¹„ìœ¨</th>
            <th onclick="sortTable('allTime')">ëˆ„ì </th>
          </tr></thead>
          <tbody id="tableBody"><tr><td colspan="10" style="text-align:center;padding:40px;color:var(--text-muted)">ë¡œë”© ì¤‘...</td></tr></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="footer">
  <span class="footer-text">ë°ì´í„°: <a href="https://defillama.com" target="_blank" class="footer-link">DefiLlama</a> ë¬´ë£Œ API Â· ì‹¤ì‹œê°„ Â· Holders Revenue = ë°”ì´ë°±&ì†Œê° + ìˆ˜ìˆ˜ë£Œì†Œê° + ìŠ¤í…Œì´ì»¤ë°°ë¶„</span>
  <span class="footer-text">í´ë ˆë²„ë¼ Â· Klevera YouTube</span>
</div>

<script>
// ===== CHAIN COLORS =====
const CC={
  'Ethereum':['#627eea','rgba(98,126,234,0.15)'],
  'Solana':['#00e599','rgba(0,229,153,0.15)'],
  'BSC':['#f0b90b','rgba(240,185,11,0.15)'],
  'Arbitrum':['#28a0f0','rgba(40,160,240,0.15)'],
  'Base':['#0052ff','rgba(0,82,255,0.15)'],
  'Polygon':['#8247e5','rgba(130,71,229,0.15)'],
  'Optimism':['#ff0420','rgba(255,4,32,0.15)'],
  'OP Mainnet':['#ff0420','rgba(255,4,32,0.15)'],
  'Avalanche':['#e84142','rgba(232,65,66,0.15)'],
  'Tron':['#eb0029','rgba(235,0,41,0.15)'],
  'Sui':['#6fbcf0','rgba(111,188,240,0.15)'],
  'Aptos':['#2ed8a3','rgba(46,216,163,0.15)'],
  'Sonic':['#ff6600','rgba(255,102,0,0.15)'],
  'Hyperliquid':['#6ee7b7','rgba(110,231,183,0.15)'],
  'Hyperliquid L1':['#6ee7b7','rgba(110,231,183,0.15)'],
  'Monad':['#836ef9','rgba(131,110,249,0.15)'],
  'Linea':['#61dfff','rgba(97,223,255,0.15)'],
  'Blast':['#fcfc03','rgba(252,252,3,0.15)'],
  'zkSync Era':['#8c8dfc','rgba(140,141,252,0.15)'],
  'ZKsync Era':['#8c8dfc','rgba(140,141,252,0.15)'],
  'Bitcoin':['#f7931a','rgba(247,147,26,0.15)'],
  'Berachain':['#f5a623','rgba(245,166,35,0.15)'],
  'Sei':['#9b1c2e','rgba(155,28,46,0.15)'],
  'Near':['#00ec97','rgba(0,236,151,0.15)'],
  'TON':['#0098ea','rgba(0,152,234,0.15)'],
  'Cronos':['#002D74','rgba(0,45,116,0.15)'],
  'Fantom':['#1969ff','rgba(25,105,255,0.15)'],
  'Scroll':['#ffeeda','rgba(255,238,218,0.15)'],
  'Starknet':['#ec796b','rgba(236,121,107,0.15)'],
  'Plasma':['#44e55c','rgba(68,229,92,0.15)'],
  'Mantle':['#9aa0a6','rgba(154,160,166,0.15)'],
  'Mode':['#dffe00','rgba(223,254,0,0.15)'],
  'Gnosis':['#3e6957','rgba(62,105,87,0.15)'],
  'Injective':['#00f2fe','rgba(0,242,254,0.15)'],
  'Osmosis':['#726bff','rgba(114,107,255,0.15)'],
  'Kaia':['#ff3d00','rgba(255,61,0,0.15)'],
};
function gc(c){
  if(CC[c]) return {color:CC[c][0],bg:CC[c][1]};
  let h=0;for(let i=0;i<c.length;i++) h=c.charCodeAt(i)+((h<<5)-h);
  const hue=Math.abs(h)%360,s=60+(Math.abs(h>>8)%20),l=55+(Math.abs(h>>16)%15);
  const col=`hsl(${hue},${s}%,${l}%)`,bg=`hsla(${hue},${s}%,${l}%,0.15)`;
  CC[c]=[col,bg];
  return {color:col,bg};
}

// ===== BUYBACK METHOD MAPPING =====
// ğŸ”¥burn, ğŸ’stake, ğŸ’¸dist, ğŸ”„mixed
const METHODS = {
  'pump.fun':'burn','pump':'burn','pumpswap':'burn',
  'hyperliquid perps':'burn','hyperliquid':'burn','hyperliquid spot orderbook':'burn',
  'ethereum':'burn','tron':'burn','bitcoin':'burn',
  'makerdao':'burn','maker':'burn','sky':'burn',
  'raydium':'burn','orca':'burn',
  'aerodrome':'stake','aerodrome slipstream':'stake',
  'velodrome v2':'stake','velodrome':'stake',
  'aave':'stake','aave v3':'stake','aave v2':'stake',
  'curve dex':'stake','curve finance':'stake','convex finance':'stake',
  'gmx':'stake','gmx v2':'stake',
  'jupiter':'burn','jupiter dca':'burn','jupiter perpetual exchange':'burn',
  'uniswap v3':'dist','uniswap':'dist','uniswap v2':'dist',
  'sushi':'burn','sushiswap':'burn',
  'lido':'dist','lido finance':'dist',
  'compound':'dist','compound v3':'dist',
  'yield basis':'burn',
  'sky lending':'burn',
  'pancakeswap amm v3':'burn','pancakeswap':'burn',
  'morpho':'dist',
  'jito':'stake',
  'marinade':'stake',
  'benqi':'stake',
  'trader joe':'burn',
  'camelot':'stake',
  'fluid':'dist',
};
function getMethod(name){
  const n=name.toLowerCase();
  if(METHODS[n]) return METHODS[n];
  // partial match
  for(const[k,v] of Object.entries(METHODS)){
    if(n.includes(k)||k.includes(n)) return v;
  }
  return null;
}
function methodLabel(m){
  if(m==='burn') return {icon:'ğŸ”¥',text:'ì†Œê°',cls:'method-burn'};
  if(m==='stake') return {icon:'ğŸ’',text:'ìŠ¤í…Œì´í‚¹',cls:'method-stake'};
  if(m==='dist') return {icon:'ğŸ’¸',text:'ì§ì ‘ë°°ë¶„',cls:'method-dist'};
  if(m==='mixed') return {icon:'ğŸ”„',text:'ë³µí•©',cls:'method-mixed'};
  return {icon:'',text:'-',cls:''};
}
function methodDotColor(m){
  if(m==='burn') return 'var(--accent-red)';
  if(m==='stake') return 'var(--accent-purple)';
  if(m==='dist') return 'var(--accent-cyan)';
  return 'var(--text-muted)';
}

// ===== STATE =====
let currentPeriod='24h', cachedData=null, currentSort={key:'holdersRevenue',dir:'desc'};

function fmtC(v){if(v==null||isNaN(v))return'-';if(Math.abs(v)>=1e9)return'$'+(v/1e9).toFixed(2)+'B';if(Math.abs(v)>=1e6)return'$'+(v/1e6).toFixed(2)+'M';if(Math.abs(v)>=1e3)return'$'+(v/1e3).toFixed(1)+'K';return'$'+v.toFixed(0)}
function fmtP(v){return(v==null||isNaN(v))?'-':v.toFixed(1)+'%'}
function pk(){return currentPeriod==='24h'?'total24h':currentPeriod==='7d'?'total7d':'total30d'}

function changePeriod(p){
  currentPeriod=p;
  document.querySelectorAll('.period-btn').forEach(b=>b.classList.remove('active'));
  document.querySelector(`[data-period="${p}"]`).classList.add('active');
  if(cachedData)renderAll(cachedData);
}
function toggleDetail(){
  const d=document.getElementById('infoDetail'),i=document.getElementById('toggleIcon');
  d.classList.toggle('show');i.textContent=d.classList.contains('show')?'â–¼':'â–¶';
}

// ===== FETCH =====
async function fetchData(){
  try{
    const[fR,hR,rR]=await Promise.all([
      fetch('https://api.llama.fi/overview/fees'),
      fetch('https://api.llama.fi/overview/fees?dataType=dailyHoldersRevenue'),
      fetch('https://api.llama.fi/overview/fees?dataType=dailyRevenue')
    ]);
    if(!fR.ok||!hR.ok||!rR.ok)throw new Error('API error');
    cachedData={fees:await fR.json(),holders:await hR.json(),revenue:await rR.json()};
    document.getElementById('statusDot').classList.remove('error');
    renderAll(cachedData);
  }catch(e){
    console.error(e);
    document.getElementById('statusDot').classList.add('error');
    document.getElementById('updateTime').textContent='ì—°ê²° ì‹¤íŒ¨';
    showError();
  }
}

function showError(){
  document.getElementById('barChart').innerHTML=`<div class="error-container"><div class="error-icon">âš ï¸</div><div class="error-text">DefiLlama API ì—°ê²° ì‹¤íŒ¨</div><div class="error-sub">GitHub Pages ë°°í¬ ì‹œ ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤</div><button class="retry-btn" onclick="fetchData()">ë‹¤ì‹œ ì‹œë„</button></div>`;
  document.getElementById('protoGrid').innerHTML='';
  document.getElementById('tableBody').innerHTML='<tr><td colspan="10" style="text-align:center;padding:40px;color:var(--text-muted)">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</td></tr>';
}

// ===== RENDER =====
function renderAll(data){
  const key=pk();
  const hMap={},rMap={};
  (data.holders.protocols||[]).forEach(h=>{hMap[h.name]=h});
  (data.revenue.protocols||[]).forEach(r=>{rMap[r.name]=r});

  const protocols=(data.fees.protocols||[]).map(p=>{
    const hm=hMap[p.name],rm=rMap[p.name];
    const holdersRevenue=hm?(hm[key]||0):0;
    const revenue=rm?(rm[key]||0):0;
    const fees=p[key]||0;
    const allTime=hm?(hm.totalAllTime||0):0;
    return {
      name:p.name||'Unknown',
      chains:p.chains||[],
      chain:(p.chains&&p.chains.length>0)?p.chains[0]:'Multi',
      category:p.category||'-',
      fees, revenue, holdersRevenue, allTime,
      ratio:revenue>0?(holdersRevenue/revenue*100):0,
      method:getMethod(p.name||'')
    };
  }).filter(p=>p.holdersRevenue>0);

  // Totals
  const totalHR=protocols.reduce((s,p)=>s+p.holdersRevenue,0);
  const totalRev=protocols.reduce((s,p)=>s+p.revenue,0);
  const totalRatio=totalRev>0?(totalHR/totalRev*100):0;

  document.getElementById('totalHR').textContent=fmtC(totalHR);
  document.getElementById('totalHRSub').textContent=`ë°”ì´ë°±+ì†Œê°+ìŠ¤í…Œì´í‚¹ ë°°ë¶„ (${currentPeriod})`;
  document.getElementById('totalRev').textContent=fmtC(totalRev);
  document.getElementById('totalRevSub').textContent=`í”„ë¡œí† ì½œ ìˆ˜ìµ í•©ê³„ (${currentPeriod})`;
  document.getElementById('totalRatio').textContent=fmtP(totalRatio);
  document.getElementById('totalCount').textContent=protocols.length;
  document.getElementById('totalCountSub').textContent=`Holders Revenue ì¡´ì¬ (${currentPeriod})`;

  const now=new Date();
  document.getElementById('updateTime').textContent=`${now.getFullYear()}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')} ì—…ë°ì´íŠ¸`;

  const sorted=[...protocols].sort((a,b)=>b.holdersRevenue-a.holdersRevenue);
  renderBarChart(sorted.slice(0,15));
  renderProtoCards(sorted.slice(0,10));
  renderTable(protocols);
}

function renderBarChart(list){
  if(!list.length){document.getElementById('barChart').innerHTML='<div style="text-align:center;padding:40px;color:var(--text-muted)">ë°ì´í„° ì—†ìŒ</div>';return}
  const mx=list[0].holdersRevenue;
  document.getElementById('barChart').innerHTML=list.map(p=>{
    const cc=gc(p.chain);
    const pct=mx>0?(p.holdersRevenue/mx*100):0;
    const mDot=methodDotColor(p.method);
    return `<div class="bar-row">
      <div class="bar-proto-name">
        <div class="bar-chain-icon" style="background:${cc.bg};color:${cc.color}">${p.chain.charAt(0)}</div>
        <span class="bar-method-dot" style="background:${mDot}"></span>
        ${p.name}
      </div>
      <div class="bar-track"><div class="bar-fill" style="width:0%;background:linear-gradient(90deg,${cc.color},${cc.color}aa)" data-w="${pct}"></div></div>
      <div class="bar-value mono" style="color:${cc.color}">${fmtC(p.holdersRevenue)}</div>
    </div>`;
  }).join('');
  requestAnimationFrame(()=>{setTimeout(()=>{document.querySelectorAll('.bar-fill').forEach(el=>{el.style.width=el.dataset.w+'%'})},50)});
}

function renderProtoCards(list){
  document.getElementById('protoGrid').innerHTML=list.map((p,i)=>{
    const cc=gc(p.chain);
    const m=p.method?methodLabel(p.method):null;
    const ratio=p.ratio;
    const rColor=ratio>50?'var(--accent-green)':ratio>20?'var(--accent-orange)':'var(--text-secondary)';
    const isFullBB=ratio>=95;

    // Multi-chain badges
    const chainBadges=(p.chains.length>0?p.chains.slice(0,3):[p.chain]).map(c=>{
      const ccc=gc(c);
      return `<span class="chain-badge" style="color:${ccc.color};border-color:${ccc.color}30"><span class="chain-badge-icon" style="background:${ccc.bg};color:${ccc.color}">${c.charAt(0)}</span>${c}</span>`;
    }).join('');

    return `<div class="proto-card">
      <div class="proto-card-top">
        <div class="proto-card-left">
          <span class="proto-rank ${i<3?'top3':''}">${i+1}</span>
          <div class="proto-name-col">
            <div class="proto-name">${p.name}</div>
            <div class="proto-category">${p.category}</div>
          </div>
        </div>
        <div class="proto-badges">
          ${m?`<span class="method-badge ${m.cls}">${m.icon} ${m.text}${isFullBB?' (100%)':''}</span>`:''}
        </div>
      </div>
      <div style="display:flex;gap:6px;flex-wrap:wrap">${chainBadges}</div>
      <div>
        <div class="proto-amount">${fmtC(p.holdersRevenue)}</div>
        ${p.allTime>0?`<div class="proto-amount-sub">ëˆ„ì  ë°”ì´ë°±: ${fmtC(p.allTime)}</div>`:''}
      </div>
      <div class="proto-metrics">
        <div class="proto-metric">
          <div class="proto-metric-label">Revenue</div>
          <div class="proto-metric-value">${fmtC(p.revenue)}</div>
        </div>
        <div class="proto-metric">
          <div class="proto-metric-label">Fees</div>
          <div class="proto-metric-value">${fmtC(p.fees)}</div>
        </div>
        <div class="proto-metric">
          <div class="proto-metric-label">ë°”ì´ë°± ë¹„ìœ¨</div>
          <div class="proto-metric-value" style="color:${rColor}">${fmtP(ratio)}</div>
        </div>
      </div>
      <div class="proto-ratio">
        <div class="proto-ratio-header">
          <span class="proto-ratio-label">Revenue â†’ Holders Revenue í™˜ì›</span>
          <span class="proto-ratio-val" style="color:${rColor}">${fmtP(ratio)}</span>
        </div>
        <div class="proto-ratio-track">
          <div class="proto-ratio-fill" style="width:${Math.min(ratio,100)}%;background:${rColor}"></div>
        </div>
      </div>
    </div>`;
  }).join('');
}

function renderTable(protocols){
  const sorted=[...protocols].sort((a,b)=>{
    const d=currentSort.dir==='desc'?-1:1,k=currentSort.key;
    if(k==='name'||k==='chain'||k==='category') return d*-1*(a[k]||'').localeCompare(b[k]||'');
    return d*((b[k]||0)-(a[k]||0));
  }).slice(0,30);

  document.getElementById('tableBody').innerHTML=sorted.map((p,i)=>{
    const cc=gc(p.chain);
    const m=p.method?methodLabel(p.method):null;
    const rColor=p.ratio>50?'var(--accent-green)':p.ratio>20?'var(--accent-orange)':'var(--text-secondary)';
    return `<tr>
      <td class="mono" style="color:var(--text-muted)">${i+1}</td>
      <td style="font-weight:500">${p.name}</td>
      <td><span class="td-chain-badge" style="border-color:${cc.color}40;color:${cc.color}">${p.chain}</span></td>
      <td style="color:var(--text-secondary)">${p.category}</td>
      <td>${m?`<span class="td-method ${m.cls}">${m.icon} ${m.text}</span>`:'-'}</td>
      <td class="mono" style="font-weight:600;color:var(--accent-green)">${fmtC(p.holdersRevenue)}</td>
      <td class="mono">${fmtC(p.revenue)}</td>
      <td class="mono">${fmtC(p.fees)}</td>
      <td class="mono" style="color:${rColor}">${fmtP(p.ratio)}</td>
      <td class="mono" style="color:var(--text-secondary)">${p.allTime>0?fmtC(p.allTime):'-'}</td>
    </tr>`;
  }).join('');
}

function sortTable(key){
  if(currentSort.key===key) currentSort.dir=currentSort.dir==='desc'?'asc':'desc';
  else currentSort={key,dir:'desc'};
  document.querySelectorAll('thead th').forEach(th=>th.classList.remove('sorted'));
  if(cachedData)renderAll(cachedData);
}

fetchData();
</script>
</body>
</html>
