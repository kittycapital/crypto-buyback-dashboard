<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í¬ë¦½í†  ë°”ì´ë°± ëŒ€ì‹œë³´ë“œ | Crypto Buyback Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-primary: #0a0a0f;
  --bg-secondary: #12121a;
  --bg-card: #16161f;
  --bg-card-hover: #1c1c28;
  --border: #2a2a3a;
  --border-light: #353545;
  --text-primary: #e8e8f0;
  --text-secondary: #8888a0;
  --text-muted: #555570;
  --accent-green: #00e599;
  --accent-green-dim: rgba(0,229,153,0.15);
  --accent-blue: #3b82f6;
  --accent-blue-dim: rgba(59,130,246,0.15);
  --accent-purple: #a855f7;
  --accent-purple-dim: rgba(168,85,247,0.15);
  --accent-orange: #f59e0b;
  --accent-orange-dim: rgba(245,158,11,0.15);
  --accent-red: #ef4444;
  --accent-red-dim: rgba(239,68,68,0.15);
  --accent-cyan: #06b6d4;
  --accent-cyan-dim: rgba(6,182,212,0.15);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Outfit', sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  min-height: 100vh;
  overflow-x: hidden;
}
.mono { font-family: 'JetBrains Mono', monospace; }

/* Header */
.header {
  padding: 24px 28px 20px;
  border-bottom: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(0,229,153,0.03) 0%, transparent 100%);
}
.header-top {
  display: flex; align-items: center; justify-content: space-between;
  flex-wrap: wrap; gap: 12px;
}
.header-left { display: flex; align-items: center; gap: 14px; }
.logo-icon {
  width: 38px; height: 38px;
  background: linear-gradient(135deg, var(--accent-green), #00b377);
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: 18px; font-weight: 800; color: #0a0a0f; letter-spacing: -1px;
}
.header h1 {
  font-size: 22px; font-weight: 700;
  background: linear-gradient(135deg, var(--text-primary), var(--accent-green));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.header-subtitle { font-size: 12px; color: var(--text-muted); margin-top: 2px; letter-spacing: 0.5px; }
.header-right { display: flex; align-items: center; gap: 10px; }
.update-badge {
  display: flex; align-items: center; gap: 6px;
  padding: 6px 12px; background: var(--bg-card);
  border: 1px solid var(--border); border-radius: 8px;
  font-size: 11px; color: var(--text-secondary);
}
.update-dot {
  width: 6px; height: 6px; background: var(--accent-green);
  border-radius: 50%; animation: pulse 2s infinite;
}
.update-dot.error { background: var(--accent-red); }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }
.period-selector {
  display: flex; background: var(--bg-card);
  border: 1px solid var(--border); border-radius: 8px; overflow: hidden;
}
.period-btn {
  padding: 6px 14px; font-size: 12px; font-weight: 500;
  background: transparent; color: var(--text-secondary);
  border: none; cursor: pointer; transition: all 0.2s;
  font-family: 'Outfit', sans-serif;
}
.period-btn.active { background: var(--accent-green); color: #0a0a0f; font-weight: 600; }
.period-btn:hover:not(.active) { color: var(--text-primary); background: var(--bg-card-hover); }

/* Info Banner */
.info-banner {
  margin: 20px 28px 0;
  background: linear-gradient(135deg, rgba(0,229,153,0.06), rgba(59,130,246,0.04));
  border: 1px solid rgba(0,229,153,0.15);
  border-radius: 12px; padding: 18px 20px;
}
.info-banner-title {
  font-size: 14px; font-weight: 600; color: var(--accent-green);
  margin-bottom: 10px; display: flex; align-items: center; gap: 8px;
}
.info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 12px;
}
.info-item { display: flex; gap: 10px; align-items: flex-start; }
.info-icon {
  width: 28px; height: 28px; border-radius: 7px;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; flex-shrink: 0; margin-top: 1px;
}
.info-item-label { font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 2px; }
.info-item-desc { font-size: 11px; color: var(--text-secondary); line-height: 1.5; }
.info-toggle {
  display: flex; align-items: center; gap: 6px;
  background: none; border: none; color: var(--accent-green);
  font-size: 12px; font-weight: 500; cursor: pointer;
  font-family: 'Outfit', sans-serif; padding: 0; margin-top: 12px;
}
.info-toggle:hover { text-decoration: underline; }
.info-detail {
  display: none; margin-top: 14px; padding-top: 14px;
  border-top: 1px solid rgba(0,229,153,0.1);
}
.info-detail.show { display: block; }
.info-detail-text { font-size: 12px; color: var(--text-secondary); line-height: 1.7; }
.info-detail-text strong { color: var(--text-primary); font-weight: 600; }
.info-highlight {
  display: inline-block; background: var(--accent-green-dim);
  color: var(--accent-green); padding: 1px 6px; border-radius: 4px;
  font-size: 11px; font-weight: 500;
}
.trad-compare {
  display: grid; grid-template-columns: 1fr auto 1fr;
  gap: 12px; margin-top: 12px; align-items: center;
}
.trad-compare-box {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 8px; padding: 10px 14px; text-align: center;
}
.trad-compare-box .label {
  font-size: 10px; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px;
}
.trad-compare-box .value { font-size: 12px; font-weight: 600; }
.trad-compare-arrow { font-size: 16px; color: var(--text-muted); text-align: center; }

/* Summary Cards */
.summary-row {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 12px; padding: 20px 28px;
}
.summary-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 12px; padding: 16px 18px; transition: all 0.3s;
}
.summary-card:hover { border-color: var(--border-light); transform: translateY(-1px); }
.summary-label {
  font-size: 11px; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 0.8px;
  margin-bottom: 8px; display: flex; align-items: center; gap: 6px;
}
.tooltip-trigger {
  display: inline-flex; align-items: center; justify-content: center;
  width: 14px; height: 14px; border-radius: 50%;
  background: var(--bg-primary); border: 1px solid var(--border);
  font-size: 9px; color: var(--text-muted); cursor: help; position: relative;
}
.tooltip-trigger:hover .tooltip-box { display: block; }
.tooltip-box {
  display: none; position: absolute; top: 100%; left: 50%;
  transform: translateX(-50%); margin-top: 6px;
  background: #22222e; border: 1px solid var(--border-light);
  border-radius: 8px; padding: 10px 12px; font-size: 11px;
  color: var(--text-secondary); line-height: 1.5; width: 220px;
  z-index: 100; font-weight: 400; text-transform: none; letter-spacing: 0;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
}
.tooltip-box::before {
  content: ''; position: absolute; top: -5px; left: 50%;
  transform: translateX(-50%) rotate(45deg);
  width: 8px; height: 8px; background: #22222e;
  border-left: 1px solid var(--border-light);
  border-top: 1px solid var(--border-light);
}
.summary-value { font-size: 24px; font-weight: 700; letter-spacing: -0.5px; }
.summary-sub { font-size: 11px; color: var(--text-secondary); margin-top: 4px; }

/* Main */
.main-content { padding: 0 28px 28px; }
.section-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 14px; flex-wrap: wrap; gap: 8px;
}
.section-title {
  font-size: 15px; font-weight: 600; color: var(--text-primary);
  display: flex; align-items: center; gap: 8px;
}
.section-title .icon { font-size: 16px; }
.section-desc { font-size: 11px; color: var(--text-muted); }

/* Bar Chart */
.chart-section { margin-bottom: 24px; }
.chart-container {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 12px; padding: 20px;
}
.bar-chart { display: flex; flex-direction: column; gap: 10px; }
.bar-row {
  display: grid; grid-template-columns: 120px 1fr 100px;
  align-items: center; gap: 12px; transition: all 0.2s;
  padding: 6px 8px; border-radius: 8px;
}
.bar-row:hover { background: rgba(255,255,255,0.02); }
.bar-chain-name {
  font-size: 13px; font-weight: 500;
  display: flex; align-items: center; gap: 8px; white-space: nowrap;
}
.chain-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.bar-track {
  height: 28px; background: rgba(255,255,255,0.03);
  border-radius: 6px; overflow: hidden;
}
.bar-fill {
  height: 100%; border-radius: 6px;
  transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  min-width: 2px;
}
.bar-value { font-size: 13px; font-weight: 600; text-align: right; white-space: nowrap; }

/* Chain Cards */
.chain-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 14px; margin-bottom: 24px;
}
.chain-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 12px; padding: 18px; transition: all 0.3s;
}
.chain-card:hover {
  border-color: var(--border-light); transform: translateY(-2px);
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
}
.chain-card-header {
  display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px;
}
.chain-card-name {
  display: flex; align-items: center; gap: 10px; font-size: 15px; font-weight: 600;
}
.chain-icon {
  width: 28px; height: 28px; border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px; font-weight: 700;
}
.chain-card-rank {
  font-size: 11px; color: var(--text-muted); background: var(--bg-primary);
  padding: 3px 8px; border-radius: 6px; font-weight: 500;
}
.chain-metrics { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.chain-metric { padding: 10px 12px; background: var(--bg-primary); border-radius: 8px; }
.chain-metric-label {
  font-size: 10px; color: var(--text-muted);
  text-transform: uppercase; letter-spacing: 0.6px; margin-bottom: 4px;
}
.chain-metric-value { font-size: 15px; font-weight: 600; }
.chain-metric-sub { font-size: 10px; color: var(--text-secondary); margin-top: 2px; }
.ratio-meter {
  margin-top: 12px; padding: 10px 12px;
  background: var(--bg-primary); border-radius: 8px;
}
.ratio-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
.ratio-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.6px; }
.ratio-value { font-size: 13px; font-weight: 600; }
.ratio-bar-track { height: 6px; background: rgba(255,255,255,0.05); border-radius: 3px; overflow: hidden; }
.ratio-bar-fill { height: 100%; border-radius: 3px; transition: width 0.6s ease; }

/* Protocol Highlights */
.proto-highlights {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
  margin-bottom: 24px;
}
.proto-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 16px;
  transition: all 0.3s;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.proto-card:hover {
  border-color: var(--border-light);
  transform: translateY(-1px);
}
.proto-card-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.proto-card-name {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  font-weight: 600;
}
.proto-card-rank-badge {
  font-size: 10px;
  padding: 2px 7px;
  border-radius: 5px;
  font-weight: 600;
}
.proto-card-amount {
  font-size: 20px;
  font-weight: 700;
  letter-spacing: -0.5px;
}
.proto-card-row {
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: var(--text-secondary);
}
.proto-card-row .label { color: var(--text-muted); }
.proto-card-row .val { font-weight: 500; }
.proto-card-bar-track {
  height: 4px;
  background: rgba(255,255,255,0.05);
  border-radius: 2px;
  overflow: hidden;
}
.proto-card-bar-fill {
  height: 100%;
  border-radius: 2px;
  transition: width 0.6s ease;
}
.buyback-100 {
  display: inline-block;
  background: rgba(239,68,68,0.15);
  color: var(--accent-red);
  font-size: 9px;
  font-weight: 600;
  padding: 1px 5px;
  border-radius: 3px;
  margin-left: 4px;
}

/* Table */
.table-section { margin-bottom: 24px; }
.table-container {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 12px; overflow: hidden;
}
.table-scroll { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; min-width: 700px; }
thead th {
  padding: 12px 16px; font-size: 10px; font-weight: 600;
  color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.8px;
  text-align: left; border-bottom: 1px solid var(--border);
  background: rgba(255,255,255,0.01); white-space: nowrap;
  cursor: pointer; user-select: none; transition: color 0.2s;
}
thead th:hover { color: var(--text-secondary); }
thead th.sorted { color: var(--accent-green); }
tbody tr { transition: background 0.15s; }
tbody tr:hover { background: rgba(255,255,255,0.02); }
tbody td {
  padding: 11px 16px; font-size: 13px;
  border-bottom: 1px solid rgba(255,255,255,0.03); white-space: nowrap;
}
.protocol-chain-badge {
  font-size: 9px; padding: 2px 6px; border-radius: 4px;
  background: var(--bg-primary); color: var(--text-secondary); border: 1px solid var(--border);
}

/* Loading/Error */
.loading-container {
  display: flex; flex-direction: column; align-items: center;
  justify-content: center; padding: 80px 20px; gap: 16px;
}
.loading-spinner {
  width: 36px; height: 36px; border: 3px solid var(--border);
  border-top-color: var(--accent-green); border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
.loading-text { font-size: 13px; color: var(--text-secondary); }
.error-container { text-align: center; padding: 60px 20px; }
.error-icon { font-size: 36px; margin-bottom: 12px; }
.error-text { font-size: 14px; color: var(--text-secondary); margin-bottom: 8px; }
.error-sub { font-size: 12px; color: var(--text-muted); margin-bottom: 16px; }
.retry-btn {
  padding: 8px 20px; background: var(--accent-green); color: #0a0a0f;
  border: none; border-radius: 8px; font-size: 13px; font-weight: 600;
  cursor: pointer; font-family: 'Outfit', sans-serif; transition: opacity 0.2s;
}
.retry-btn:hover { opacity: 0.85; }

/* Footer */
.footer {
  padding: 16px 28px; border-top: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
  flex-wrap: wrap; gap: 8px;
}
.footer-text { font-size: 11px; color: var(--text-muted); }
.footer-link { color: var(--accent-green); text-decoration: none; }
.footer-link:hover { text-decoration: underline; }

/* Responsive */
@media (max-width: 768px) {
  .header { padding: 16px; }
  .header h1 { font-size: 18px; }
  .info-banner { margin: 12px 16px 0; padding: 14px 16px; }
  .info-grid { grid-template-columns: 1fr; }
  .trad-compare { grid-template-columns: 1fr; gap: 6px; }
  .trad-compare-arrow { transform: rotate(90deg); }
  .summary-row { padding: 12px 16px; gap: 8px; }
  .summary-card { padding: 12px 14px; }
  .summary-value { font-size: 20px; }
  .main-content { padding: 0 16px 16px; }
  .chain-grid { grid-template-columns: 1fr; }
  .bar-row { grid-template-columns: 90px 1fr 80px; gap: 8px; }
  .bar-chain-name { font-size: 12px; }
  .footer { padding: 12px 16px; }
  .period-selector { order: 3; }
}
@media (max-width: 480px) {
  .summary-row { grid-template-columns: 1fr 1fr; }
  .header-top { flex-direction: column; align-items: flex-start; }
}
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--border-light); }
</style>
</head>
<body>

<div class="header">
  <div class="header-top">
    <div class="header-left">
      <div class="logo-icon">BB</div>
      <div>
        <h1>í¬ë¦½í†  ë°”ì´ë°± ëŒ€ì‹œë³´ë“œ</h1>
        <div class="header-subtitle">CRYPTO BUYBACK & TOKEN HOLDER REVENUE BY CHAIN</div>
      </div>
    </div>
    <div class="header-right">
      <div class="update-badge">
        <span class="update-dot" id="statusDot"></span>
        <span id="updateTime">ë¡œë”© ì¤‘...</span>
      </div>
      <div class="period-selector">
        <button class="period-btn active" data-period="24h" onclick="changePeriod('24h')">24H</button>
        <button class="period-btn" data-period="7d" onclick="changePeriod('7d')">7D</button>
        <button class="period-btn" data-period="30d" onclick="changePeriod('30d')">30D</button>
      </div>
    </div>
  </div>
</div>

<!-- ========== EXPLANATION BANNER ========== -->
<div class="info-banner">
  <div class="info-banner-title">ğŸ’¡ í¬ë¦½í†  ë°”ì´ë°±ì´ë€?</div>
  <div class="info-grid">
    <div class="info-item">
      <div class="info-icon" style="background:var(--accent-green-dim);color:var(--accent-green)">ğŸ’°</div>
      <div>
        <div class="info-item-label">Holders Revenue (í™€ë” ìˆ˜ìµ)</div>
        <div class="info-item-desc">í”„ë¡œí† ì½œ ìˆ˜ìµ ì¤‘ <strong>í† í° ë³´ìœ ìì—ê²Œ ëŒë ¤ì£¼ëŠ” ê¸ˆì•¡</strong>ì…ë‹ˆë‹¤. ì£¼ì‹ì˜ ë°°ë‹¹ê¸ˆ + ìì‚¬ì£¼ë§¤ì…ê³¼ ê°™ì€ ê°œë…ì…ë‹ˆë‹¤.</div>
      </div>
    </div>
    <div class="info-item">
      <div class="info-icon" style="background:var(--accent-blue-dim);color:var(--accent-blue)">ğŸ”¥</div>
      <div>
        <div class="info-item-label">í™˜ì› ë°©ì‹</div>
        <div class="info-item-desc"><strong>í† í° ë°”ì´ë°± & ì†Œê°</strong> (ê³µê¸‰ ê°ì†Œ â†’ ê°€ê²© ìƒìŠ¹), <strong>ìˆ˜ìˆ˜ë£Œ ì†Œê°</strong>, <strong>ìŠ¤í…Œì´ì»¤ ì§ì ‘ ë°°ë¶„</strong> ë“±ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</div>
      </div>
    </div>
    <div class="info-item">
      <div class="info-icon" style="background:var(--accent-purple-dim);color:var(--accent-purple)">ğŸ“Š</div>
      <div>
        <div class="info-item-label">ë°”ì´ë°± ë¹„ìœ¨</div>
        <div class="info-item-desc">Revenue ëŒ€ë¹„ Holders Revenue ë¹„ìœ¨ì´ ë†’ì„ìˆ˜ë¡ <strong>íˆ¬ìì í™˜ì›ì— ì ê·¹ì </strong>ì¸ í”„ë¡œí† ì½œì…ë‹ˆë‹¤.</div>
      </div>
    </div>
  </div>

  <button class="info-toggle" onclick="toggleDetail()">
    <span id="toggleIcon">â–¶</span> ì£¼ì‹ íˆ¬ììë¥¼ ìœ„í•œ ìƒì„¸ ë¹„êµ ë³´ê¸°
  </button>

  <div class="info-detail" id="infoDetail">
    <div class="trad-compare">
      <div class="trad-compare-box">
        <div class="label">ğŸ¢ ì£¼ì‹ (TradFi)</div>
        <div class="value" style="color:var(--accent-blue)">ë§¤ì¶œ â†’ ì˜ì—…ì´ìµ â†’ ë°°ë‹¹ + ìì‚¬ì£¼ë§¤ì…</div>
      </div>
      <div class="trad-compare-arrow">â‰ˆ</div>
      <div class="trad-compare-box">
        <div class="label">â›“ï¸ í¬ë¦½í†  (DeFi)</div>
        <div class="value" style="color:var(--accent-green)">Fees â†’ Revenue â†’ Holders Revenue</div>
      </div>
    </div>
    <div class="info-detail-text" style="margin-top:14px;">
      <strong>Fees (ìˆ˜ìˆ˜ë£Œ)</strong> = ì‚¬ìš©ìê°€ í”„ë¡œí† ì½œì— ì§€ë¶ˆí•˜ëŠ” ì´ ê¸ˆì•¡ â†’ ì£¼ì‹ì˜ <span class="info-highlight">ë§¤ì¶œì•¡</span><br>
      <strong>Revenue (ìˆ˜ìµ)</strong> = í”„ë¡œí† ì½œì´ ê°€ì ¸ê°€ëŠ” ìˆ˜ìµ (LP ë³´ìƒ ì œì™¸) â†’ <span class="info-highlight">ì˜ì—…ì´ìµ</span><br>
      <strong>Holders Revenue</strong> = í† í° ë³´ìœ ìì—ê²Œ ëŒì•„ê°€ëŠ” ê¸ˆì•¡ â†’ <span class="info-highlight">ë°°ë‹¹ê¸ˆ + ìì‚¬ì£¼ë§¤ì…</span><br><br>
      ğŸ’¡ <strong>í•µì‹¬:</strong> ë°”ì´ë°± ë¹„ìœ¨ì´ ë†’ì€ ì²´ì¸/í”„ë¡œí† ì½œ = ì‹¤ì œ ìˆ˜ìµì„ íˆ¬ììì—ê²Œ í™˜ì›í•˜ëŠ” <strong>"ê°€ì¹˜ì£¼"</strong> ìŠ¤íƒ€ì¼ì˜ í¬ë¦½í†  í”„ë¡œì íŠ¸!<br><br>
      ğŸ”¥ <strong>ëŒ€í‘œ ì‚¬ë¡€ â€” Pump.fun:</strong> Revenueì˜ <span class="info-highlight">100%</span>ë¥¼ ë§¤ì¼ PUMP í† í° ë°”ì´ë°±ì— ì‚¬ìš©. ëˆ„ì  $98M+ ë°”ì´ë°±ìœ¼ë¡œ ìœ í†µëŸ‰ 6.7% ê°ì†Œ. ì£¼ì‹ìœ¼ë¡œ ì¹˜ë©´ ì˜ì—…ì´ìµ ì „ì•¡ì„ ìì‚¬ì£¼ë§¤ì…ì— ì“°ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤.
    </div>
  </div>
</div>

<!-- ========== SUMMARY CARDS ========== -->
<div class="summary-row">
  <div class="summary-card">
    <div class="summary-label">
      ì „ì²´ Holders Revenue
      <span class="tooltip-trigger">?
        <div class="tooltip-box">ì „ì²´ ì²´ì¸ì—ì„œ í† í° ë³´ìœ ìì—ê²Œ í™˜ì›ëœ ì´ ê¸ˆì•¡. ë°”ì´ë°±Â·ì†Œê°Â·ìŠ¤í…Œì´í‚¹ ë³´ìƒ í¬í•¨.</div>
      </span>
    </div>
    <div class="summary-value" id="totalHoldersRev">-</div>
    <div class="summary-sub" id="totalHoldersRevSub">ë°”ì´ë°± + ì†Œê° + ìŠ¤í…Œì´ì»¤ ë°°ë¶„</div>
  </div>
  <div class="summary-card">
    <div class="summary-label">
      ì „ì²´ Revenue
      <span class="tooltip-trigger">?
        <div class="tooltip-box">í”„ë¡œí† ì½œë“¤ì˜ ìì²´ ìˆ˜ìµ í•©ê³„. LP ë³´ìƒ ì œì™¸. ì£¼ì‹ì˜ ì˜ì—…ì´ìµê³¼ ìœ ì‚¬.</div>
      </span>
    </div>
    <div class="summary-value" id="totalRevenue">-</div>
    <div class="summary-sub" id="totalRevenueSub">í”„ë¡œí† ì½œ ìˆ˜ìµ í•©ê³„</div>
  </div>
  <div class="summary-card">
    <div class="summary-label">
      ì „ì²´ Fees
      <span class="tooltip-trigger">?
        <div class="tooltip-box">ì‚¬ìš©ìë“¤ì´ í”„ë¡œí† ì½œ ì´ìš© ì‹œ ì§€ë¶ˆí•œ ì´ ìˆ˜ìˆ˜ë£Œ. ì£¼ì‹ì˜ ë§¤ì¶œì•¡ê³¼ ìœ ì‚¬.</div>
      </span>
    </div>
    <div class="summary-value" id="totalFees">-</div>
    <div class="summary-sub" id="totalFeesSub">ì‚¬ìš©ì ìˆ˜ìˆ˜ë£Œ í•©ê³„</div>
  </div>
  <div class="summary-card">
    <div class="summary-label">
      ë°”ì´ë°± ë¹„ìœ¨
      <span class="tooltip-trigger">?
        <div class="tooltip-box">Revenue ì¤‘ í† í° ë³´ìœ ìì—ê²Œ í™˜ì›ëœ ë¹„ìœ¨. ì£¼ì‹ì˜ ì£¼ì£¼í™˜ì›ìœ¨(ë°°ë‹¹ì„±í–¥+ìì‚¬ì£¼ë§¤ì…ë¹„ìœ¨)ê³¼ ë™ì¼ ê°œë….</div>
      </span>
    </div>
    <div class="summary-value" id="totalRatio">-</div>
    <div class="summary-sub">Holders Revenue Ã· Revenue</div>
  </div>
</div>

<div class="main-content">
  <!-- ========== BAR CHART ========== -->
  <div class="chart-section">
    <div class="section-header">
      <div>
        <div class="section-title"><span class="icon">ğŸ“Š</span> ì²´ì¸ë³„ ë°”ì´ë°±(Holders Revenue) ë¹„êµ</div>
        <div class="section-desc">ê° ë¸”ë¡ì²´ì¸ ë„¤íŠ¸ì›Œí¬ì—ì„œ í† í° ë³´ìœ ìì—ê²Œ í™˜ì›ëœ ê¸ˆì•¡ ìˆœìœ„</div>
      </div>
    </div>
    <div class="chart-container">
      <div class="bar-chart" id="barChart">
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <div class="loading-text">DefiLlama APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== PROTOCOL HIGHLIGHTS ========== -->
  <div class="section-header">
    <div>
      <div class="section-title"><span class="icon">ğŸ”¥</span> ë°”ì´ë°± ìƒìœ„ í”„ë¡œí† ì½œ TOP 10</div>
      <div class="section-desc">Holders Revenueê°€ ê°€ì¥ ë§ì€ ê°œë³„ í”„ë¡œí† ì½œ Â· Pump.fun ë“± 100% ë°”ì´ë°± í”„ë¡œí† ì½œ í¬í•¨</div>
    </div>
  </div>
  <div class="proto-highlights" id="protoHighlights"></div>

  <!-- ========== CHAIN CARDS ========== -->
  <div class="section-header">
    <div>
      <div class="section-title"><span class="icon">â›“ï¸</span> ì²´ì¸ë³„ ìƒì„¸ ë¶„ì„</div>
      <div class="section-desc">Fees â†’ Revenue â†’ Holders Revenue íë¦„ê³¼ ë°”ì´ë°± ë¹„ìœ¨</div>
    </div>
  </div>
  <div class="chain-grid" id="chainGrid"></div>

  <!-- ========== PROTOCOL TABLE ========== -->
  <div class="table-section">
    <div class="section-header">
      <div>
        <div class="section-title"><span class="icon">ğŸ†</span> ë°”ì´ë°± ìƒìœ„ í”„ë¡œí† ì½œ</div>
        <div class="section-desc">Holders Revenue ê¸°ì¤€ ìƒìœ„ 30ê°œ í”„ë¡œí† ì½œ Â· ì—´ í´ë¦­ ì‹œ ì •ë ¬</div>
      </div>
    </div>
    <div class="table-container">
      <div class="table-scroll">
        <table>
          <thead>
            <tr>
              <th onclick="sortTable('rank')">#</th>
              <th onclick="sortTable('name')">í”„ë¡œí† ì½œ</th>
              <th onclick="sortTable('chain')">ì²´ì¸</th>
              <th onclick="sortTable('category')">ì¹´í…Œê³ ë¦¬</th>
              <th onclick="sortTable('holdersRevenue')" class="sorted">Holders Rev. â–¼</th>
              <th onclick="sortTable('revenue')">Revenue</th>
              <th onclick="sortTable('fees')">Fees</th>
              <th onclick="sortTable('ratio')">ë°”ì´ë°± ë¹„ìœ¨</th>
            </tr>
          </thead>
          <tbody id="protocolTableBody">
            <tr><td colspan="8" style="text-align:center;padding:40px;color:var(--text-muted);">ë¡œë”© ì¤‘...</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="footer">
  <span class="footer-text">ë°ì´í„°: <a href="https://defillama.com" target="_blank" class="footer-link">DefiLlama</a> ë¬´ë£Œ API Â· ì‹¤ì‹œê°„ Â· Holders Revenue = ë°”ì´ë°±&ì†Œê° + ìˆ˜ìˆ˜ë£Œì†Œê° + ìŠ¤í…Œì´ì»¤ë°°ë¶„</span>
  <span class="footer-text">í´ë ˆë²„ë¼ Â· Klevera YouTube</span>
</div>

<script>
const CHAIN_COLORS = {
  'Ethereum':{'color':'#627eea','bg':'rgba(98,126,234,0.15)'},
  'Solana':{'color':'#00e599','bg':'rgba(0,229,153,0.15)'},
  'BSC':{'color':'#f0b90b','bg':'rgba(240,185,11,0.15)'},
  'Arbitrum':{'color':'#28a0f0','bg':'rgba(40,160,240,0.15)'},
  'Base':{'color':'#0052ff','bg':'rgba(0,82,255,0.15)'},
  'Polygon':{'color':'#8247e5','bg':'rgba(130,71,229,0.15)'},
  'Optimism':{'color':'#ff0420','bg':'rgba(255,4,32,0.15)'},
  'Avalanche':{'color':'#e84142','bg':'rgba(232,65,66,0.15)'},
  'Tron':{'color':'#eb0029','bg':'rgba(235,0,41,0.15)'},
  'Fantom':{'color':'#1969ff','bg':'rgba(25,105,255,0.15)'},
  'Sui':{'color':'#6fbcf0','bg':'rgba(111,188,240,0.15)'},
  'Aptos':{'color':'#2ed8a3','bg':'rgba(46,216,163,0.15)'},
  'Sonic':{'color':'#ff6600','bg':'rgba(255,102,0,0.15)'},
  'Mantle':{'color':'#9aa0a6','bg':'rgba(154,160,166,0.15)'},
  'zkSync Era':{'color':'#8c8dfc','bg':'rgba(140,141,252,0.15)'},
  'ZKsync Era':{'color':'#8c8dfc','bg':'rgba(140,141,252,0.15)'},
  'Hyperliquid':{'color':'#6ee7b7','bg':'rgba(110,231,183,0.15)'},
  'Hyperliquid L1':{'color':'#6ee7b7','bg':'rgba(110,231,183,0.15)'},
  'Bitcoin':{'color':'#f7931a','bg':'rgba(247,147,26,0.15)'},
  'Monad':{'color':'#836ef9','bg':'rgba(131,110,249,0.15)'},
  'Linea':{'color':'#61dfff','bg':'rgba(97,223,255,0.15)'},
  'Blast':{'color':'#fcfc03','bg':'rgba(252,252,3,0.15)'},
  'Scroll':{'color':'#ffeeda','bg':'rgba(255,238,218,0.15)'},
  'Cronos':{'color':'#002D74','bg':'rgba(0,45,116,0.15)'},
  'Gnosis':{'color':'#3e6957','bg':'rgba(62,105,87,0.15)'},
  'Celo':{'color':'#fcff52','bg':'rgba(252,255,82,0.15)'},
  'Manta':{'color':'#1fc7d4','bg':'rgba(31,199,212,0.15)'},
  'Berachain':{'color':'#f5a623','bg':'rgba(245,166,35,0.15)'},
  'Sei':{'color':'#9b1c2e','bg':'rgba(155,28,46,0.15)'},
  'Near':{'color':'#00ec97','bg':'rgba(0,236,151,0.15)'},
  'Starknet':{'color':'#ec796b','bg':'rgba(236,121,107,0.15)'},
  'Cardano':{'color':'#0033ad','bg':'rgba(0,51,173,0.15)'},
  'Cosmos':{'color':'#6f7390','bg':'rgba(111,115,144,0.15)'},
  'Injective':{'color':'#00f2fe','bg':'rgba(0,242,254,0.15)'},
  'TON':{'color':'#0098ea','bg':'rgba(0,152,234,0.15)'},
  'Polkadot':{'color':'#e6007a','bg':'rgba(230,0,122,0.15)'},
  'Mode':{'color':'#dffe00','bg':'rgba(223,254,0,0.15)'},
  'Osmosis':{'color':'#726bff','bg':'rgba(114,107,255,0.15)'},
  'Terra Classic':{'color':'#5493f7','bg':'rgba(84,147,247,0.15)'},
  'Algorand':{'color':'#000000','bg':'rgba(100,100,100,0.15)'},
  'Kaia':{'color':'#ff3d00','bg':'rgba(255,61,0,0.15)'},
  'OP Mainnet':{'color':'#ff0420','bg':'rgba(255,4,32,0.15)'},
  'Plasma':{'color':'#44e55c','bg':'rgba(68,229,92,0.15)'},
  'opBNB':{'color':'#f0b90b','bg':'rgba(240,185,11,0.15)'},
  'Moonbeam':{'color':'#53cbc8','bg':'rgba(83,203,200,0.15)'},
  'Aurora':{'color':'#78d64b','bg':'rgba(120,214,75,0.15)'},
  'Metis':{'color':'#00d2ff','bg':'rgba(0,210,255,0.15)'},
  'Merlin':{'color':'#f7931a','bg':'rgba(247,147,26,0.15)'},
  'Flare':{'color':'#e42058','bg':'rgba(228,32,88,0.15)'},
  'Hedera':{'color':'#8259ef','bg':'rgba(130,89,239,0.15)'},
  'MultiversX':{'color':'#23f7dd','bg':'rgba(35,247,221,0.15)'},
  'Solana':{'color':'#00e599','bg':'rgba(0,229,153,0.15)'},
};

function gc(chain) {
  if (CHAIN_COLORS[chain]) return CHAIN_COLORS[chain];
  // Generate a consistent bright color from chain name
  let hash = 0;
  for (let i = 0; i < chain.length; i++) hash = chain.charCodeAt(i) + ((hash << 5) - hash);
  const h = Math.abs(hash) % 360;
  const s = 60 + (Math.abs(hash >> 8) % 20); // 60-80% saturation
  const l = 55 + (Math.abs(hash >> 16) % 15); // 55-70% lightness (bright on dark bg)
  const color = `hsl(${h}, ${s}%, ${l}%)`;
  const bg = `hsla(${h}, ${s}%, ${l}%, 0.15)`;
  CHAIN_COLORS[chain] = {color, bg};
  return {color, bg};
}

let currentPeriod = '24h';
let cachedData = null;
let currentSort = {key:'holdersRevenue', dir:'desc'};

function fmtC(v) {
  if(v==null||isNaN(v)) return '-';
  if(Math.abs(v)>=1e9) return '$'+(v/1e9).toFixed(2)+'B';
  if(Math.abs(v)>=1e6) return '$'+(v/1e6).toFixed(2)+'M';
  if(Math.abs(v)>=1e3) return '$'+(v/1e3).toFixed(1)+'K';
  return '$'+v.toFixed(0);
}
function fmtP(v) { return (v==null||isNaN(v)) ? '-' : v.toFixed(1)+'%'; }
function pk() { return currentPeriod==='24h'?'total24h':currentPeriod==='7d'?'total7d':'total30d'; }

function changePeriod(p) {
  currentPeriod=p;
  document.querySelectorAll('.period-btn').forEach(b=>b.classList.remove('active'));
  document.querySelector(`[data-period="${p}"]`).classList.add('active');
  if(cachedData) renderAll(cachedData);
}

function toggleDetail() {
  const d=document.getElementById('infoDetail');
  const i=document.getElementById('toggleIcon');
  d.classList.toggle('show');
  i.textContent=d.classList.contains('show')?'â–¼':'â–¶';
}

async function fetchData() {
  try {
    // Fetch both fees overview AND holders revenue data
    const [feesRes, holdersRes, revenueRes] = await Promise.all([
      fetch('https://api.llama.fi/overview/fees'),
      fetch('https://api.llama.fi/overview/fees?dataType=dailyHoldersRevenue'),
      fetch('https://api.llama.fi/overview/fees?dataType=dailyRevenue')
    ]);
    if(!feesRes.ok||!holdersRes.ok||!revenueRes.ok) throw new Error('API error');
    const feesData = await feesRes.json();
    const holdersData = await holdersRes.json();
    const revenueData = await revenueRes.json();
    cachedData = {feesData, holdersData, revenueData};
    document.getElementById('statusDot').classList.remove('error');
    renderAll(cachedData);
  } catch(err) {
    console.error('Fetch error:', err);
    document.getElementById('statusDot').classList.add('error');
    document.getElementById('updateTime').textContent='ì—°ê²° ì‹¤íŒ¨';
    showError();
  }
}

function showError() {
  document.getElementById('barChart').innerHTML=`
    <div class="error-container">
      <div class="error-icon">âš ï¸</div>
      <div class="error-text">DefiLlama API ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</div>
      <div class="error-sub">GitHub Pagesì— ë°°í¬í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ë°ì´í„°ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
      <button class="retry-btn" onclick="fetchData()">ë‹¤ì‹œ ì‹œë„</button>
    </div>`;
  document.getElementById('chainGrid').innerHTML='';
  document.getElementById('protocolTableBody').innerHTML=
    '<tr><td colspan="8" style="text-align:center;padding:40px;color:var(--text-muted);">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</td></tr>';
}

function renderAll(data) {
  const {feesData, holdersData, revenueData} = data;
  const key = pk();

  // Build lookup maps
  const holdersMap = {};
  (holdersData.protocols||[]).forEach(h => { holdersMap[h.name]=h; });
  const revenueMap = {};
  (revenueData.protocols||[]).forEach(r => { revenueMap[r.name]=r; });

  // Build protocol list
  const protocols = (feesData.protocols||[]).map(p => {
    const hm = holdersMap[p.name];
    const rm = revenueMap[p.name];
    const holdersRevenue = hm ? (hm[key]||0) : 0;
    const revenue = rm ? (rm[key]||0) : 0;
    const fees = p[key] || 0;
    return {
      name: p.name||'Unknown',
      chains: p.chains||[],
      chain: (p.chains&&p.chains.length>0)?p.chains[0]:'Multi',
      category: p.category||'-',
      fees, revenue, holdersRevenue,
      ratio: revenue>0?(holdersRevenue/revenue*100):0,
    };
  }).filter(p => p.holdersRevenue > 0);

  // Aggregate by chain
  const chainMap = {};
  protocols.forEach(p => {
    const cs = (p.chains&&p.chains.length>0)?p.chains:[p.chain];
    cs.forEach(c => {
      if(!chainMap[c]) chainMap[c]={chain:c, holdersRevenue:0, revenue:0, fees:0, protocols:0};
      chainMap[c].holdersRevenue += p.holdersRevenue;
      chainMap[c].revenue += p.revenue;
      chainMap[c].fees += p.fees;
      chainMap[c].protocols++;
    });
  });
  const chainList = Object.values(chainMap).sort((a,b)=>b.holdersRevenue-a.holdersRevenue).slice(0,15);

  // Totals (deduplicated - use protocol level)
  const totalHR = protocols.reduce((s,p)=>s+p.holdersRevenue,0);
  const totalRev = protocols.reduce((s,p)=>s+p.revenue,0);
  const totalF = protocols.reduce((s,p)=>s+p.fees,0);
  const totalRatio = totalRev>0?(totalHR/totalRev*100):0;

  document.getElementById('totalHoldersRev').textContent=fmtC(totalHR);
  document.getElementById('totalHoldersRevSub').textContent=`ë°”ì´ë°± + ì†Œê° + ìŠ¤í…Œì´ì»¤ ë°°ë¶„ (${currentPeriod})`;
  document.getElementById('totalRevenue').textContent=fmtC(totalRev);
  document.getElementById('totalRevenueSub').textContent=`í”„ë¡œí† ì½œ ìˆ˜ìµ í•©ê³„ (${currentPeriod})`;
  document.getElementById('totalFees').textContent=fmtC(totalF);
  document.getElementById('totalFeesSub').textContent=`ì‚¬ìš©ì ìˆ˜ìˆ˜ë£Œ í•©ê³„ (${currentPeriod})`;
  document.getElementById('totalRatio').textContent=fmtP(totalRatio);

  const now=new Date();
  document.getElementById('updateTime').textContent=
    `${now.getFullYear()}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')} ì—…ë°ì´íŠ¸`;

  renderBarChart(chainList);
  renderProtoHighlights(protocols);
  renderChainCards(chainList, totalHR);
  renderProtocolTable(protocols);
}

function renderProtoHighlights(protocols) {
  const top10 = [...protocols].sort((a,b) => b.holdersRevenue - a.holdersRevenue).slice(0,10);
  if (!top10.length) {
    document.getElementById('protoHighlights').innerHTML = '';
    return;
  }
  const maxHR = top10[0].holdersRevenue;
  // Known 100% buyback protocols
  const fullBuyback = ['pump.fun','pump','pumpswap'];

  document.getElementById('protoHighlights').innerHTML = top10.map((p, i) => {
    const cc = gc(p.chain);
    const pct = maxHR > 0 ? (p.holdersRevenue / maxHR * 100) : 0;
    const isFullBB = fullBuyback.some(fb => p.name.toLowerCase().includes(fb)) || p.ratio >= 95;
    const rankColors = ['var(--accent-green)','var(--accent-green)','var(--accent-green)','var(--accent-blue)','var(--accent-blue)'];
    const rankColor = rankColors[Math.min(i, rankColors.length-1)] || 'var(--text-secondary)';
    const rankBg = i < 3 ? 'var(--accent-green-dim)' : i < 5 ? 'var(--accent-blue-dim)' : 'var(--bg-primary)';

    return `<div class="proto-card">
      <div class="proto-card-top">
        <div class="proto-card-name">
          <span class="proto-card-rank-badge" style="background:${rankBg};color:${rankColor}">#${i+1}</span>
          ${p.name}${isFullBB ? '<span class="buyback-100">100% ë°”ì´ë°±</span>' : ''}
        </div>
        <span class="protocol-chain-badge" style="border-color:${cc.color}40;color:${cc.color}">${p.chain}</span>
      </div>
      <div class="proto-card-amount" style="color:var(--accent-green)">${fmtC(p.holdersRevenue)}</div>
      <div class="proto-card-bar-track">
        <div class="proto-card-bar-fill" style="width:${pct}%;background:${cc.color}"></div>
      </div>
      <div class="proto-card-row">
        <span class="label">Revenue</span><span class="val">${fmtC(p.revenue)}</span>
      </div>
      <div class="proto-card-row">
        <span class="label">Fees</span><span class="val">${fmtC(p.fees)}</span>
      </div>
      <div class="proto-card-row">
        <span class="label">ë°”ì´ë°± ë¹„ìœ¨</span>
        <span class="val" style="color:${p.ratio>50?'var(--accent-green)':p.ratio>20?'var(--accent-orange)':'var(--text-secondary)'}">${fmtP(p.ratio)}</span>
      </div>
    </div>`;
  }).join('');
}

function renderBarChart(chains) {
  if(!chains.length) {
    document.getElementById('barChart').innerHTML='<div style="text-align:center;padding:40px;color:var(--text-muted)">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
    return;
  }
  const mx=chains[0].holdersRevenue;
  document.getElementById('barChart').innerHTML=chains.map(c=>{
    const cc=gc(c.chain);
    const pct=mx>0?(c.holdersRevenue/mx*100):0;
    return `<div class="bar-row">
      <div class="bar-chain-name"><span class="chain-dot" style="background:${cc.color}"></span>${c.chain}</div>
      <div class="bar-track"><div class="bar-fill" style="width:0%;background:linear-gradient(90deg,${cc.color},${cc.color}aa)" data-w="${pct}"></div></div>
      <div class="bar-value mono" style="color:${cc.color}">${fmtC(c.holdersRevenue)}</div>
    </div>`;
  }).join('');
  requestAnimationFrame(()=>{setTimeout(()=>{
    document.querySelectorAll('.bar-fill').forEach(el=>{el.style.width=el.dataset.w+'%';});
  },50);});
}

function renderChainCards(chains, totalHR) {
  document.getElementById('chainGrid').innerHTML=chains.slice(0,9).map((c,i)=>{
    const cc=gc(c.chain);
    const ratio=c.revenue>0?(c.holdersRevenue/c.revenue*100):0;
    const share=totalHR>0?(c.holdersRevenue/totalHR*100):0;
    const feeToRev=c.fees>0?(c.revenue/c.fees*100):0;
    const rColor=ratio>50?'var(--accent-green)':ratio>20?'var(--accent-orange)':'var(--text-secondary)';
    return `<div class="chain-card">
      <div class="chain-card-header">
        <div class="chain-card-name">
          <div class="chain-icon" style="background:${cc.bg};color:${cc.color}">${c.chain.charAt(0)}</div>${c.chain}
        </div>
        <span class="chain-card-rank">#${i+1} Â· ${c.protocols}ê°œ í”„ë¡œí† ì½œ</span>
      </div>
      <div class="chain-metrics">
        <div class="chain-metric">
          <div class="chain-metric-label">ğŸ’° Holders Revenue</div>
          <div class="chain-metric-value" style="color:${cc.color}">${fmtC(c.holdersRevenue)}</div>
          <div class="chain-metric-sub">ì „ì²´ì˜ ${fmtP(share)}</div>
        </div>
        <div class="chain-metric">
          <div class="chain-metric-label">ğŸ“ˆ Revenue</div>
          <div class="chain-metric-value">${fmtC(c.revenue)}</div>
          <div class="chain-metric-sub">Feesì˜ ${fmtP(feeToRev)}</div>
        </div>
        <div class="chain-metric">
          <div class="chain-metric-label">ğŸ”„ Total Fees</div>
          <div class="chain-metric-value">${fmtC(c.fees)}</div>
        </div>
        <div class="chain-metric">
          <div class="chain-metric-label">ğŸ—ï¸ í”„ë¡œí† ì½œ ìˆ˜</div>
          <div class="chain-metric-value">${c.protocols}</div>
        </div>
      </div>
      <div class="ratio-meter">
        <div class="ratio-header">
          <span class="ratio-label">ë°”ì´ë°± ë¹„ìœ¨ (Revenue ëŒ€ë¹„)</span>
          <span class="ratio-value" style="color:${rColor}">${fmtP(ratio)}</span>
        </div>
        <div class="ratio-bar-track">
          <div class="ratio-bar-fill" style="width:${Math.min(ratio,100)}%;background:${rColor}"></div>
        </div>
      </div>
    </div>`;
  }).join('');
}

function renderProtocolTable(protocols) {
  const sorted=[...protocols].sort((a,b)=>{
    const d=currentSort.dir==='desc'?-1:1;
    const k=currentSort.key;
    if(k==='name'||k==='chain'||k==='category') return d*-1*(a[k]||'').localeCompare(b[k]||'');
    return d*((b[k]||0)-(a[k]||0));
  }).slice(0,30);

  document.getElementById('protocolTableBody').innerHTML=sorted.map((p,i)=>{
    const cc=gc(p.chain);
    const rc=p.ratio>50?'var(--accent-green)':p.ratio>20?'var(--accent-orange)':'var(--text-secondary)';
    return `<tr>
      <td class="mono" style="color:var(--text-muted)">${i+1}</td>
      <td><span style="font-weight:500">${p.name}</span></td>
      <td><span class="protocol-chain-badge" style="border-color:${cc.color}40;color:${cc.color}">${p.chain}</span></td>
      <td style="color:var(--text-secondary)">${p.category}</td>
      <td class="mono" style="font-weight:600;color:var(--accent-green)">${fmtC(p.holdersRevenue)}</td>
      <td class="mono">${fmtC(p.revenue)}</td>
      <td class="mono">${fmtC(p.fees)}</td>
      <td class="mono" style="color:${rc}">${fmtP(p.ratio)}</td>
    </tr>`;
  }).join('');
}

function sortTable(key) {
  if(currentSort.key===key) currentSort.dir=currentSort.dir==='desc'?'asc':'desc';
  else currentSort={key,dir:'desc'};
  document.querySelectorAll('thead th').forEach(th=>th.classList.remove('sorted'));
  if(cachedData) renderAll(cachedData);
}

fetchData();
</script>
</body>
</html>
